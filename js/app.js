!function(e){function webpackJsonpCallback(t){for(var n,o,i=t[0],s=t[1],c=0,u=[];c<i.length;c++)o=i[c],r[o]&&u.push(r[o][0]),r[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(a&&a(t);u.length;)u.shift()()}var t={},n={"4":0},r={"4":0};function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={"i":n,"l":!1,"exports":{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}__webpack_require__.e=function requireEnsure(e){var t=[];n[e]?t.push(n[e]):0!==n[e]&&{"0":1,"1":1,"3":1}[e]&&t.push(n[e]=new Promise(function(t,n){for(var r="css/"+({"2":"identified_index","3":"index_index"}[e]||e)+".css",o=__webpack_require__.p+r,i=document.getElementsByTagName("link"),s=0;s<i.length;s++){var a=(u=i[s]).getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(a===r||a===o))return t()}var c=document.getElementsByTagName("style");for(s=0;s<c.length;s++){var u;if((a=(u=c[s]).getAttribute("data-href"))===r||a===o)return t()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=t,l.onerror=function(t){var r=t&&t.target&&t.target.src||o,i=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");i.request=r,n(i)},l.href=o,document.getElementsByTagName("head")[0].appendChild(l)}).then(function(){n[e]=0}));var o=r[e];if(0!==o)if(o)t.push(o[2]);else{var i=new Promise(function(t,n){o=r[e]=[t,n]});t.push(o[2]=i);var s,a=document.getElementsByTagName("head")[0],c=document.createElement("script");c.charset="utf-8",c.timeout=120,__webpack_require__.nc&&c.setAttribute("nonce",__webpack_require__.nc),c.src=function jsonpScriptSrc(e){return __webpack_require__.p+"chunk/"+({"2":"identified_index","3":"index_index"}[e]||e)+".js"}(e),s=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+o+": "+i+")");s.type=o,s.request=i,n[1](s)}r[e]=void 0}};var u=setTimeout(function(){s({"type":"timeout","target":c})},12e4);c.onerror=c.onload=s,a.appendChild(c)}return Promise.all(t)},__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{"enumerable":!0,"get":n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{"value":"Module"}),Object.defineProperty(e,"__esModule",{"value":!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{"enumerable":!0,"value":e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/me/",__webpack_require__.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],i=o.push.bind(o);o.push=webpackJsonpCallback,o=o.slice();for(var s=0;s<o.length;s++)webpackJsonpCallback(o[s]);var a=i;__webpack_require__(__webpack_require__.s=43)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(7),o=function(){function Utils(){}return Utils.compareObjects=function(e,t){return!(!e||!t)&&!(!e.userIdentifier||!t.userIdentifier||e.userIdentifier!==t.userIdentifier)},Utils.expiresIn=function(e){return e||(e="3599"),this.now()+parseInt(e,10)},Utils.now=function(){return Math.round((new Date).getTime()/1e3)},Utils.isEmpty=function(e){return void 0===e||!e||0===e.length},Utils.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this.base64DecodeStringUrlSafe(n);return r?JSON.parse(r):null}catch(e){}return null},Utils.base64EncodeStringUrlSafe=function(e){return window.btoa?window.btoa(e):this.encode(e)},Utils.base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(encodeURIComponent(window.atob(e))):decodeURIComponent(encodeURIComponent(this.decode(e)))},Utils.encode=function(e){var t,n,r,o,i,s,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(e=this.utf8Encode(e);l<e.length;)o=(t=e.charCodeAt(l++))>>2,i=(3&t)<<4|(n=e.charCodeAt(l++))>>4,s=(15&n)<<2|(r=e.charCodeAt(l++))>>6,a=63&r,isNaN(n)?s=a=64:isNaN(r)&&(a=64),u=u+c.charAt(o)+c.charAt(i)+c.charAt(s)+c.charAt(a);return u.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},Utils.utf8Encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},Utils.decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,o,i,s,a,c,u,l,p="",d=0;d<n;d+=4){if(r=t.indexOf(e.charAt(d)),o=t.indexOf(e.charAt(d+1)),i=t.indexOf(e.charAt(d+2)),s=t.indexOf(e.charAt(d+3)),d+2===n-1){c=(a=r<<18|o<<12|i<<6)>>16&255,u=a>>8&255,p+=String.fromCharCode(c,u);break}if(d+1===n-1){c=(a=r<<18|o<<12)>>16&255,p+=String.fromCharCode(c);break}c=(a=r<<18|o<<12|i<<6|s)>>16&255,u=a>>8&255,l=255&a,p+=String.fromCharCode(c,u,l)}return p},Utils.decodeJwt=function(e){if(this.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{"header":t[1],"JWSPayload":t[2],"JWSSig":t[3]}},Utils.deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},i={};for(t=r.exec(e);t;)i[o(t[1])]=o(t[2]),t=r.exec(e);return i},Utils.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var n=0;n<t.length;n++)if(e.indexOf(t[n].toLowerCase())>-1)return!0;return!1},Utils.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every(function(t){return e.indexOf(t.toString().toLowerCase())>=0})},Utils.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase()})},Utils.removeElement=function(e,t){return e.filter(function(e){return e!==t})},Utils.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},Utils.getLibraryVersion=function(){return"0.2.4"},Utils.replaceFirstPath=function(e,t){if(!t)return e;var n=this.GetUrlComponents(e),o=n.PathSegments;return 0===o.length||o[0]!==r.Constants.common&&o[0]!==r.Constants.organizations||(o[0]=t,e=n.Protocol+"//"+n.HostNameAndPort+"/"+o.join("/")),e},Utils.createNewGuid=function(){var e=window.crypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,Utils.decimalToHex(t[0])+Utils.decimalToHex(t[1])+Utils.decimalToHex(t[2])+Utils.decimalToHex(t[3])+"-"+Utils.decimalToHex(t[4])+Utils.decimalToHex(t[5])+"-"+Utils.decimalToHex(t[6])+Utils.decimalToHex(t[7])+"-"+Utils.decimalToHex(t[8])+Utils.decimalToHex(t[9])+"-"+Utils.decimalToHex(t[10])+Utils.decimalToHex(t[11])+Utils.decimalToHex(t[12])+Utils.decimalToHex(t[13])+Utils.decimalToHex(t[14])+Utils.decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(o=16*Math.random()|0),"x"===n[s]?i+=r[o]:"y"===n[s]?(o&=3,i+=r[o|=8]):i+=n[s];return i},Utils.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=e.match(t);if(!n||n.length<6)throw"Valid url required";var r={"Protocol":n[1],"HostNameAndPort":n[4],"AbsolutePath":n[5]},o=r.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),r.PathSegments=o,r},Utils.CanonicalizeUri=function(e){return e&&(e=e.toLowerCase()),e&&!Utils.endsWith(e,"/")&&(e+="/"),e},Utils.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},Utils.checkSSO=function(e){return!(e&&(-1!==e.indexOf(r.Constants.login_hint)||-1!==e.indexOf(r.Constants.sid)))},Utils.constructUnifiedCacheExtraQueryParameter=function(e,t){return e?e.hasOwnProperty(r.Constants.upn)?(t=this.urlRemoveQueryStringParameter(t,r.Constants.login_hint),(t=this.urlRemoveQueryStringParameter(t,r.Constants.domain_hint))?t+"&"+r.Constants.login_hint+"="+e.upn+"&"+r.Constants.domain_hint+"="+r.Constants.organizations:"&"+r.Constants.login_hint+"="+e.upn+"&"+r.Constants.domain_hint+"="+r.Constants.organizations):(t=this.urlRemoveQueryStringParameter(t,r.Constants.domain_hint))?t+"&"+r.Constants.domain_hint+"="+r.Constants.organizations:"&"+r.Constants.domain_hint+"="+r.Constants.organizations:t},Utils.urlRemoveQueryStringParameter=function(e,t){if(this.isEmpty(e))return e;var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e=e.replace(n,"")},Utils}();t.Utils=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(n(36)),o=function randomString(){return Math.random().toString(36).substring(7).split("").join(".")},i={"INIT":"@@redux/INIT"+o(),"REPLACE":"@@redux/REPLACE"+o(),"PROBE_UNKNOWN_ACTION":function PROBE_UNKNOWN_ACTION(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function isPlainObject(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function getUndefinedStateErrorMessage(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function bindActionCreator(e,t){return function(){return t(e.apply(this,arguments))}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{"value":n,"enumerable":!0,"configurable":!0,"writable":!0}):e[t]=n,e}function compose(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}t.createStore=function createStore(e,t,n){var o;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(createStore)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var s=e,a=t,c=[],u=c,l=!1;function ensureCanMutateNextListeners(){u===c&&(u=c.slice())}function getState(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function subscribe(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return ensureCanMutateNextListeners(),u.push(e),function unsubscribe(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,ensureCanMutateNextListeners();var n=u.indexOf(e);u.splice(n,1)}}}function dispatch(e){if(!isPlainObject(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,a=s(a,e)}finally{l=!1}for(var t=c=u,n=0;n<t.length;n++)(0,t[n])();return e}return dispatch({"type":i.INIT}),(o={"dispatch":dispatch,"subscribe":subscribe,"getState":getState,"replaceReducer":function replaceReducer(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");s=e,dispatch({"type":i.REPLACE})}})[r]=function observable(){var e,t=subscribe;return(e={"subscribe":function subscribe(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function observeState(){e.next&&e.next(getState())}return observeState(),{"unsubscribe":t(observeState)}}})[r]=function(){return this},e},o},t.combineReducers=function combineReducers(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}var s,a=Object.keys(n);try{!function assertReducerShape(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{"type":i.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{"type":i.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+i.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(e){s=e}return function combination(e,t){if(void 0===e&&(e={}),s)throw s;for(var r=!1,o={},i=0;i<a.length;i++){var c=a[i],u=n[c],l=e[c],p=u(l,t);if(void 0===p){var d=getUndefinedStateErrorMessage(c,t);throw new Error(d)}o[c]=p,r=r||p!==l}return r?o:e}},t.bindActionCreators=function bindActionCreators(e,t){if("function"==typeof e)return bindActionCreator(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),r={},o=0;o<n.length;o++){var i=n[o],s=e[i];"function"==typeof s&&(r[i]=bindActionCreator(s,t))}return r},t.applyMiddleware=function applyMiddleware(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function dispatch(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={"getState":n.getState,"dispatch":function dispatch(){return r.apply(void 0,arguments)}},i=t.map(function(e){return e(o)});return function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){_defineProperty(e,t,n[t])})}return e}({},n,{"dispatch":r=compose.apply(void 0,i)(n.dispatch)})}}},t.compose=compose,t.__DO_NOT_USE__ActionTypes=i},function(e,t,n){e.exports=n(8)(0)},function(e,t,n){e.exports=n(8)(2)},function(e,t,n){e.exports=n(8)(1)},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return s});var r="ADD",o="MINUS",i="LOGIN",s="LOGOUT"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(0),o=n(10),i=n(14);!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C"}(t.AuthorityType||(t.AuthorityType={}));var s=function(){function Authority(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(Authority.prototype,"Tenant",{"get":function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},"enumerable":!0,"configurable":!0}),Object.defineProperty(Authority.prototype,"AuthorizationEndpoint",{"get":function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},"enumerable":!0,"configurable":!0}),Object.defineProperty(Authority.prototype,"EndSessionEndpoint",{"get":function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},"enumerable":!0,"configurable":!0}),Object.defineProperty(Authority.prototype,"SelfSignedJwtAudience",{"get":function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},"enumerable":!0,"configurable":!0}),Authority.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(Authority.prototype,"CanonicalAuthority",{"get":function(){return this.canonicalAuthority},"set":function(e){this.canonicalAuthority=r.Utils.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},"enumerable":!0,"configurable":!0}),Object.defineProperty(Authority.prototype,"CanonicalAuthorityUrlComponents",{"get":function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=r.Utils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},"enumerable":!0,"configurable":!0}),Object.defineProperty(Authority.prototype,"DefaultOpenIdConfigurationEndpoint",{"get":function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},"enumerable":!0,"configurable":!0}),Authority.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw o.ErrorMessage.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw o.ErrorMessage.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw o.ErrorMessage.authorityUriInvalidPath},Authority.prototype.DiscoverEndpoints=function(e){return(new i.XhrClient).sendRequestAsync(e,"GET",!0).then(function(e){return{"AuthorizationEndpoint":e.authorization_endpoint,"EndSessionEndpoint":e.end_session_endpoint,"Issuer":e.issuer}})},Authority.prototype.ResolveEndpointsAsync=function(){var e=this,t="";return this.GetOpenIdConfigurationEndpointAsync().then(function(n){return t=n,e.DiscoverEndpoints(t)}).then(function(t){return e.tenantDiscoveryResponse=t,e})},Authority}();t.Authority=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=function(){function Constants(){}return Object.defineProperty(Constants,"errorDescription",{"get":function(){return"error_description"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"error",{"get":function(){return"error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"scope",{"get":function(){return"scope"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"acquireTokenUser",{"get":function(){return"msal.acquireTokenUser"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"clientInfo",{"get":function(){return"client_info"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"clientId",{"get":function(){return"clientId"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"authority",{"get":function(){return"msal.authority"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"idToken",{"get":function(){return"id_token"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"accessToken",{"get":function(){return"access_token"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"expiresIn",{"get":function(){return"expires_in"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"sessionState",{"get":function(){return"session_state"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"msalClientInfo",{"get":function(){return"msal.client.info"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"msalError",{"get":function(){return"msal.error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"msalErrorDescription",{"get":function(){return"msal.error.description"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"msalSessionState",{"get":function(){return"msal.session.state"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"tokenKeys",{"get":function(){return"msal.token.keys"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"accessTokenKey",{"get":function(){return"msal.access.token.key"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"expirationKey",{"get":function(){return"msal.expiration.key"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"stateLogin",{"get":function(){return"msal.state.login"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"stateAcquireToken",{"get":function(){return"msal.state.acquireToken"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"stateRenew",{"get":function(){return"msal.state.renew"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"nonceIdToken",{"get":function(){return"msal.nonce.idtoken"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"userName",{"get":function(){return"msal.username"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"idTokenKey",{"get":function(){return"msal.idtoken"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"loginRequest",{"get":function(){return"msal.login.request"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"loginError",{"get":function(){return"msal.login.error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"renewStatus",{"get":function(){return"msal.token.renew.status"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"msal",{"get":function(){return"msal"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"no_user",{"get":function(){return"NO_USER"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"login_hint",{"get":function(){return"login_hint"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"domain_hint",{"get":function(){return"domain_hint"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"organizations",{"get":function(){return"organizations"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"consumers",{"get":function(){return"consumers"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"consumersUtid",{"get":function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"sid",{"get":function(){return"sid"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"upn",{"get":function(){return"upn"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"adalIdToken",{"get":function(){return"adal.idtoken"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"prompt_select_account",{"get":function(){return"&prompt=select_account"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"prompt_none",{"get":function(){return"&prompt=none"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"prompt",{"get":function(){return"prompt"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"response_mode_fragment",{"get":function(){return"&response_mode=fragment"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"resourceDelimeter",{"get":function(){return"|"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"tokenRenewStatusCancelled",{"get":function(){return"Canceled"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"tokenRenewStatusCompleted",{"get":function(){return"Completed"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"tokenRenewStatusInProgress",{"get":function(){return"In Progress"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"popUpWidth",{"get":function(){return this._popUpWidth},"set":function(e){this._popUpWidth=e},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"popUpHeight",{"get":function(){return this._popUpHeight},"set":function(e){this._popUpHeight=e},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"login",{"get":function(){return"LOGIN"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"renewToken",{"get":function(){return"RENEW_TOKEN"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"unknown",{"get":function(){return"UNKNOWN"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"urlHash",{"get":function(){return"msal.urlHash"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"angularLoginRequest",{"get":function(){return"msal.angular.login.request"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"userIdentifier",{"get":function(){return"userIdentifier"},"enumerable":!0,"configurable":!0}),Object.defineProperty(Constants,"common",{"get":function(){return"common"},"enumerable":!0,"configurable":!0}),Constants._popUpWidth=483,Constants._popUpHeight=600,Constants}();t.Constants=r;var o=function(){function ErrorCodes(){}return Object.defineProperty(ErrorCodes,"loginProgressError",{"get":function(){return"login_progress_error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorCodes,"acquireTokenProgressError",{"get":function(){return"acquiretoken_progress_error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorCodes,"inputScopesError",{"get":function(){return"input_scopes_error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorCodes,"endpointResolutionError",{"get":function(){return"endpoints_resolution_error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorCodes,"popUpWindowError",{"get":function(){return"popup_window_error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorCodes,"userLoginError",{"get":function(){return"user_login_error"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorCodes,"userCancelledError",{"get":function(){return"user_cancelled"},"enumerable":!0,"configurable":!0}),ErrorCodes}();t.ErrorCodes=o;var i=function(){function ErrorDescription(){}return Object.defineProperty(ErrorDescription,"loginProgressError",{"get":function(){return"Login is in progress"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorDescription,"acquireTokenProgressError",{"get":function(){return"Acquire token is in progress"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorDescription,"inputScopesError",{"get":function(){return"Invalid value of input scopes provided"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorDescription,"endpointResolutionError",{"get":function(){return"Endpoints cannot be resolved"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorDescription,"popUpWindowError",{"get":function(){return"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorDescription,"userLoginError",{"get":function(){return"User login is required"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorDescription,"userCancelledError",{"get":function(){return"User closed the popup window and cancelled the flow"},"enumerable":!0,"configurable":!0}),ErrorDescription}();t.ErrorDescription=i},function(e,t){e.exports=lib},function(e,t,n){(function(n){var r,o,i,s,a,c,u,l,p,d,f,h,g,m,y,v,b;!function(w){var _="object"==typeof n?n:"object"==typeof self?self:"object"==typeof this?this:{};function createExporter(e,t){return function(n,r){return e[n]=t?t(n,r):r}}void 0===(r=function(e){var t,n;t=createExporter(_,createExporter(e)),n=Object.setPrototypeOf||{"__proto__":[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o=function(e,t){function __(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)},i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]]);return n},a=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},c=function(e,t){return function(n,r){t(n,r,e)}},u=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function fulfilled(e){try{step(r.next(e))}catch(e){i(e)}}function rejected(e){try{step(r.throw(e))}catch(e){i(e)}}function step(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(fulfilled,rejected)}step((r=r.apply(e,t||[])).next())})},p=function(e,t){var n,r,o,i,s={"label":0,"sent":function(){if(1&o[0])throw o[1];return o[1]},"trys":[],"ops":[]};return i={"next":verb(0),"throw":verb(1),"return":verb(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function verb(i){return function(a){return function step(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{"value":i[1],"done":!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{"value":i[0]?i[1]:void 0,"done":!0}}([i,a])}}},d=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},f=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{"next":function(){return e&&n>=e.length&&(e=void 0),{"value":e&&e[n++],"done":!e}}}},h=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={"error":e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},g=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e},m=function(e){return this instanceof m?(this.v=e,this):new m(e)},y=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},verb("next"),verb("throw"),verb("return"),r[Symbol.asyncIterator]=function(){return this},r;function verb(e){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||resume(e,t)})})}function resume(e,t){try{!function step(e){e.value instanceof m?Promise.resolve(e.value.v).then(fulfill,reject):settle(i[0][2],e)}(o[e](t))}catch(e){settle(i[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),i.shift(),i.length&&resume(i[0][0],i[0][1])}},v=function(e){var t,n;return t={},verb("next"),verb("throw",function(e){throw e}),verb("return"),t[Symbol.iterator]=function(){return this},t;function verb(r,o){e[r]&&(t[r]=function(t){return(n=!n)?{"value":m(e[r](t)),"done":"return"===r}:o?o(t):t})}},b=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):"function"==typeof f?f(e):e[Symbol.iterator]()},t("__extends",o),t("__assign",i),t("__rest",s),t("__decorate",a),t("__param",c),t("__metadata",u),t("__awaiter",l),t("__generator",p),t("__exportStar",d),t("__values",f),t("__read",h),t("__spread",g),t("__await",m),t("__asyncGenerator",y),t("__asyncDelegator",v),t("__asyncValues",b)}.apply(t,[t]))||(e.exports=r)}()}).call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=function(){function ErrorMessage(){}return Object.defineProperty(ErrorMessage,"authorityUriInvalidPath",{"get":function(){return"AuthorityUriInvalidPath"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorMessage,"authorityUriInsecure",{"get":function(){return"AuthorityUriInsecure"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorMessage,"invalidAuthorityType",{"get":function(){return"InvalidAuthorityType"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorMessage,"unsupportedAuthorityValidation",{"get":function(){return"UnsupportedAuthorityValidation"},"enumerable":!0,"configurable":!0}),Object.defineProperty(ErrorMessage,"b2cAuthorityUriInvalidPath",{"get":function(){return"B2cAuthorityUriInvalidPath"},"enumerable":!0,"configurable":!0}),ErrorMessage}();t.ErrorMessage=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r,o=n(0);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(r=t.LogLevel||(t.LogLevel={}));var i=function(){function Logger(e,t){void 0===t&&(t={}),this._level=r.Info;var n=t.correlationId,o=void 0===n?"":n,i=t.level,s=void 0===i?r.Info:i,a=t.piiLoggingEnabled,c=void 0!==a&&a;this._localCallback=e,this._correlationId=o,this._level=s,this._piiLoggingEnabled=c}return Logger.prototype.logMessage=function(e,t,n){if(!(e>this._level||!this._piiLoggingEnabled&&n)){var i,s=(new Date).toUTCString();i=o.Utils.isEmpty(this._correlationId)?s+":"+o.Utils.getLibraryVersion()+"-"+r[e]+" "+t:s+":"+this._correlationId+"-"+o.Utils.getLibraryVersion()+"-"+r[e]+" "+t,this.executeCallback(e,i,n)}},Logger.prototype.executeCallback=function(e,t,n){this._localCallback&&this._localCallback(e,t,n)},Logger.prototype.error=function(e){this.logMessage(r.Error,e,!1)},Logger.prototype.errorPii=function(e){this.logMessage(r.Error,e,!0)},Logger.prototype.warning=function(e){this.logMessage(r.Warning,e,!1)},Logger.prototype.warningPii=function(e){this.logMessage(r.Warning,e,!0)},Logger.prototype.info=function(e){this.logMessage(r.Info,e,!1)},Logger.prototype.infoPii=function(e){this.logMessage(r.Info,e,!0)},Logger.prototype.verbose=function(e){this.logMessage(r.Verbose,e,!1)},Logger.prototype.verbosePii=function(e){this.logMessage(r.Verbose,e,!0)},Logger}();t.Logger=i},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(19),o=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var i="bacb8d3b-6ee0-4443-9bea-b54485a5a20d",s="https://login.microsoftonline.com/tfp/unihearti.onmicrosoft.com/B2C_1_tictactoe",a=["https://unihearti.onmicrosoft.com/hello/demo.read"],c=new r.UserAgentApplication(i,s,function(e,t,n,r){console.log(e,t,n,r)}),u=function(){function User(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,User)}return o(User,null,[{"key":"getAgent","value":function getAgent(){return c}},{"key":"get","value":function get(){return c.getUser()}},{"key":"login","value":function login(){c.loginRedirect(a)}},{"key":"logout","value":function logout(){c.logout()}}]),User}()},function(e,t,n){e.exports=function(e,t,n){"use strict";function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{"value":n,"enumerable":!0,"configurable":!0,"writable":!0}):e[t]=n,e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){_defineProperty(e,t,n[t])})}return e}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var r=[],o=Array.isArray,i={"only":function only(e){if(1!==(e=i.toArray(e)).length)throw new Error("Provider expects only one child.");return e[0]},"toArray":function toArray(e){return null===e||void 0===e?[]:o(e)?e:r.concat(e)}};function proptype(){}proptype.isRequired=proptype;var s=function getProptype(){return proptype},a={"element":s,"func":s,"shape":s,"instanceOf":s},c=a.shape({"trySubscribe":a.func.isRequired,"tryUnsubscribe":a.func.isRequired,"notifyNestedSubs":a.func.isRequired,"isSubscribed":a.func.isRequired}),u=a.shape({"subscribe":a.func.isRequired,"dispatch":a.func.isRequired,"getState":a.func.isRequired}),l=function createProvider(e){var n;void 0===e&&(e="store");var r=e+"Subscription",o=function(t){_inheritsLoose(Provider,t);var n=Provider.prototype;function Provider(n,r){var o;return(o=t.call(this,n,r)||this)[e]=n.store,o}return n.getChildContext=function getChildContext(){var t;return(t={})[e]=this[e],t[r]=null,t},n.render=function render(){return i.only(this.props.children)},Provider}(t.Component);return o.childContextTypes=((n={})[e]=u.isRequired,n[r]=c,n),o}(),p={"childContextTypes":!0,"contextTypes":!0,"defaultProps":!0,"displayName":!0,"getDefaultProps":!0,"getDerivedStateFromProps":!0,"mixins":!0,"propTypes":!0,"type":!0},d={"name":!0,"length":!0,"prototype":!0,"caller":!0,"callee":!0,"arguments":!0,"arity":!0},f=Object.defineProperty,h=Object.getOwnPropertyNames,g=Object.getOwnPropertySymbols,m=Object.getOwnPropertyDescriptor,y=Object.getPrototypeOf,v=y&&y(Object),b=function hoistNonReactStatics(e,t,n){if("string"!=typeof t){if(v){var r=y(t);r&&r!==v&&hoistNonReactStatics(e,r,n)}var o=h(t);g&&(o=o.concat(g(t)));for(var i=0;i<o.length;++i){var s=o[i];if(!(p[s]||d[s]||n&&n[s])){var a=m(t,s);try{f(e,s,a)}catch(e){}}}return e}return e},w=function(){},_=null,C={"notify":function notify(){}},I=function(){function Subscription(e,t,n){this.store=e,this.parentSub=t,this.onStateChange=n,this.unsubscribe=null,this.listeners=C}var e=Subscription.prototype;return e.addNestedSub=function addNestedSub(e){return this.trySubscribe(),this.listeners.subscribe(e)},e.notifyNestedSubs=function notifyNestedSubs(){this.listeners.notify()},e.isSubscribed=function isSubscribed(){return Boolean(this.unsubscribe)},e.trySubscribe=function trySubscribe(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.onStateChange):this.store.subscribe(this.onStateChange),this.listeners=function createListenerCollection(){var e=[],t=[];return{"clear":function clear(){t=_,e=_},"notify":function notify(){for(var n=e=t,r=0;r<n.length;r++)n[r]()},"get":function get(){return t},"subscribe":function subscribe(n){var r=!0;return t===e&&(t=e.slice()),t.push(n),function unsubscribe(){r&&e!==_&&(r=!1,t===e&&(t=e.slice()),t.splice(t.indexOf(n),1))}}}}())},e.tryUnsubscribe=function tryUnsubscribe(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=C)},Subscription}(),P=function tryToCall(e,t){if(void 0===t&&(t=null),e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return t?e.apply(t,r):e.apply(void 0,r)}},S=function getRoute(e){var t=e.vnode;return e.isRoute?e:t?t._owner?getRoute(t._owner):e:{}},k=0,A={};function noop(){}function connectAdvanced(n,r){var o,i;void 0===r&&(r={});var s=r,a=s.getDisplayName,l=void 0===a?function(e){return"ConnectAdvanced("+e+")"}:a,p=s.methodName,d=void 0===p?"connectAdvanced":p,f=s.renderCountProp,h=void 0===f?void 0:f,g=s.shouldHandleStateChanges,m=void 0===g||g,y=s.storeKey,v=void 0===y?"store":y,_=s.withRef,C=void 0!==_&&_,T=_objectWithoutPropertiesLoose(s,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef"]),E=v+"Subscription",U=k++,O=((o={})[v]=u,o[E]=c,o),x=((i={})[E]=c,i);return function wrapWithConnect(r){w("function"==typeof r,"You must pass a component to the function returned by "+d+". Instead received "+JSON.stringify(r));var o=r.displayName||r.name||"Component",i=l(o),s=_objectSpread({},T,{"getDisplayName":l,"methodName":d,"renderCountProp":h,"shouldHandleStateChanges":m,"storeKey":v,"withRef":C,"displayName":i,"wrappedComponentName":o,"WrappedComponent":r}),a=function(t){function Connect(e,n){var r;return _defineProperty(_assertThisInitialized(_assertThisInitialized(r=t.call(this,e,n)||this)),"setWrappedInstance",function(e){null!==e&&(r.wrappedInstance=e)}),r.version=U,r.state={},r.renderCount=0,r.store=e[v]||n[v],r.propsMode=Boolean(e[v]),w(r.store,'Could not find "'+v+'" in either the context or props of "'+i+'". Either wrap the root component in a <Provider>, or explicitly pass "'+v+'" as a prop to "'+i+'".'),r.initSelector(),r.initSubscription(),r}_inheritsLoose(Connect,t);var o=Connect.prototype;return o.getChildContext=function getChildContext(){var e,t=this.propsMode?null:this.subscription;return(e={})[E]=t||this.context[E],e},o.componentDidMount=function componentDidMount(){m&&(this.subscription.trySubscribe(),this.selector.run(this.props,{"ctx":this}),this.selector.shouldComponentUpdate&&this.forceUpdate())},o.componentDidShow=function componentDidShow(){this.selector.__needForceUpdate&&(this.forceUpdate(),this.selector.__needForceUpdate=!1),P(this.wrappedInstance.componentDidShow,this.wrappedInstance)},o.componentWillReceiveProps=function componentWillReceiveProps(e){this.selector.run(e,{"ctx":this})},o.shouldComponentUpdate=function shouldComponentUpdate(){return this.selector.shouldComponentUpdate},o.componentWillUnmount=function componentWillUnmount(){this.subscription&&this.subscription.tryUnsubscribe(),this.subscription=null,this.notifyNestedSubs=noop,this.store=null,this.selector.run=noop,this.selector.shouldComponentUpdate=!1},o.componentDidHide=function componentDidHide(){P(this.wrappedInstance.componentDidHide,this.wrappedInstance)},o.getWrappedInstance=function getWrappedInstance(){return this.wrappedInstance},o.initSelector=function initSelector(){var e=n(this.store.dispatch,s);this.selector=function makeSelectorStateful(e,t){var n={"run":function runComponentSelector(r,o){var i=o.ctx;try{var s=e(t.getState(),r);if(s!==n.props||n.error){n.shouldComponentUpdate=!0;var a=S(i);a.matched||(n.__needForceUpdate=!0,n.shouldComponentUpdate=!1),n.props=s,n.error=null}}catch(e){n.shouldComponentUpdate=!0,n.error=e}}};return n}(e,this.store),this.selector.run(this.props,{"ctx":this})},o.initSubscription=function initSubscription(){if(m){var e=(this.propsMode?this.props:this.context)[E];this.subscription=new I(this.store,e,this.onStateChange.bind(this)),this.notifyNestedSubs=this.subscription.notifyNestedSubs.bind(this.subscription)}},o.onStateChange=function onStateChange(){this.selector.run(this.props,{"ctx":this}),this.selector.shouldComponentUpdate?(this.componentDidUpdate=this.notifyNestedSubsOnComponentDidUpdate,this.setState(A)):this.notifyNestedSubs()},o.notifyNestedSubsOnComponentDidUpdate=function notifyNestedSubsOnComponentDidUpdate(){this.componentDidUpdate=void 0,this.notifyNestedSubs()},o.isSubscribed=function isSubscribed(){return Boolean(this.subscription)&&this.subscription.isSubscribed()},o.addExtraProps=function addExtraProps(e){var t=_objectSpread({},e);return t.ref=this.setWrappedInstance,h&&(t[h]=this.renderCount++),this.propsMode&&this.subscription&&(t[E]=this.subscription),t},o.render=function render(){var t=this.selector;if(t.shouldComponentUpdate=!1,t.error)throw t.error;return e.createElement(r,this.addExtraProps(t.props))},function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(Connect,[{"key":"config","get":function get(){return this.wrappedInstance?this.wrappedInstance.config:{}}}]),Connect}(t.Component);return a.WrappedComponent=r,a.displayName=i,a.childContextTypes=x,a.contextTypes=O,b(a,r)}}var T=Object.prototype.hasOwnProperty;function is(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function shallowEqual(e,t){if(is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!T.call(t,n[o])||!is(e[n[o]],t[n[o]]))return!1;return!0}function wrapMapToPropsConstant(e){return function initConstantSelector(t,n){var r=e(t,n);function constantSelector(){return r}return constantSelector.dependsOnOwnProps=!1,constantSelector}}function getDependsOnOwnProps(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function wrapMapToPropsFunc(e,t){return function initProxySelector(t,n){n.displayName;var r=function mapToPropsProxy(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function detectFactoryAndVerify(t,n){r.mapToProps=e,r.dependsOnOwnProps=getDependsOnOwnProps(e);var o=r(t,n);return"function"==typeof o&&(r.mapToProps=o,r.dependsOnOwnProps=getDependsOnOwnProps(o),o=r(t,n)),o},r}}var E=[function whenMapDispatchToPropsIsFunction(e){return"function"==typeof e?wrapMapToPropsFunc(e):void 0},function whenMapDispatchToPropsIsMissing(e){return e?void 0:wrapMapToPropsConstant(function(e){return{"dispatch":e}})},function whenMapDispatchToPropsIsObject(e){return e&&"object"==typeof e?wrapMapToPropsConstant(function(t){return n.bindActionCreators(e,t)}):void 0}],U=[function whenMapStateToPropsIsFunction(e){return"function"==typeof e?wrapMapToPropsFunc(e):void 0},function whenMapStateToPropsIsMissing(e){return e?void 0:wrapMapToPropsConstant(function(){return{}})}];function defaultMergeProps(e,t,n){return _objectSpread({},n,e,t)}var O=[function whenMergePropsIsFunction(e){return"function"==typeof e?function wrapMergePropsFunc(e){return function initMergePropsProxy(t,n){n.displayName;var r,o=n.pure,i=n.areMergedPropsEqual,s=!1;return function mergePropsProxy(t,n,a){var c=e(t,n,a);return s?o&&i(c,r)||(r=c):(s=!0,r=c),r}}}(e):void 0},function whenMergePropsIsOmitted(e){return e?void 0:function(){return defaultMergeProps}}];function impureFinalPropsSelectorFactory(e,t,n,r){return function impureFinalPropsSelector(o,i){return n(e(o,i),t(r,i),i)}}function pureFinalPropsSelectorFactory(e,t,n,r,o){var i,s,a,c,u,l=o.areStatesEqual,p=o.areOwnPropsEqual,d=o.areStatePropsEqual,f=!1;function handleSubsequentCalls(o,f){var h=!p(f,s),g=!l(o,i);return i=o,s=f,h&&g?function handleNewPropsAndNewState(){return a=e(i,s),t.dependsOnOwnProps&&(c=t(r,s)),u=n(a,c,s)}():h?function handleNewProps(){return e.dependsOnOwnProps&&(a=e(i,s)),t.dependsOnOwnProps&&(c=t(r,s)),u=n(a,c,s)}():g?function handleNewState(){var t=e(i,s),r=!d(t,a);return a=t,r&&(u=n(a,c,s)),u}():u}return function pureFinalPropsSelector(o,l){return f?handleSubsequentCalls(o,l):function handleFirstCall(o,l){return a=e(i=o,s=l),c=t(r,s),u=n(a,c,s),f=!0,u}(o,l)}}function finalPropsSelectorFactory(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,o=t.initMergeProps,i=_objectWithoutPropertiesLoose(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),s=n(e,i),a=r(e,i),c=o(e,i),u=i.pure?pureFinalPropsSelectorFactory:impureFinalPropsSelectorFactory;return u(s,a,c,e,i)}function match(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function strictEqual(e,t){return e===t}var x=function createConnect(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?connectAdvanced:n,o=t.mapStateToPropsFactories,i=void 0===o?U:o,s=t.mapDispatchToPropsFactories,a=void 0===s?E:s,c=t.mergePropsFactories,u=void 0===c?O:c,l=t.selectorFactory,p=void 0===l?finalPropsSelectorFactory:l;return function connect(e,t,n,o){void 0===o&&(o={});var s=o,c=s.pure,l=void 0===c||c,d=s.areStatesEqual,f=void 0===d?strictEqual:d,h=s.areOwnPropsEqual,g=void 0===h?shallowEqual:h,m=s.areStatePropsEqual,y=void 0===m?shallowEqual:m,v=s.areMergedPropsEqual,b=void 0===v?shallowEqual:v,w=_objectWithoutPropertiesLoose(s,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),_=match(e,i,"mapStateToProps"),C=match(t,a,"mapDispatchToProps"),I=match(n,u,"mergeProps");return r(p,_objectSpread({"methodName":"connect","getDisplayName":function getDisplayName(e){return"Connect("+e+")"},"shouldHandleStateChanges":Boolean(e),"initMapStateToProps":_,"initMapDispatchToProps":C,"initMergeProps":I,"pure":l,"areStatesEqual":f,"areOwnPropsEqual":g,"areStatePropsEqual":y,"areMergedPropsEqual":b},w))}}();return{"Provider":l,"connect":x,"connectAdvanced":connectAdvanced}}(n(2),n(3),n(1))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=function(){function XhrClient(){}return XhrClient.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise(function(n,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){(i.status<200||i.status>=300)&&o(r.handleError(i.responseText));try{var t=JSON.parse(i.responseText)}catch(e){o(r.handleError(i.responseText))}n(t)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()})},XhrClient.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},XhrClient}();t.XhrClient=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(9),o=n(6),i=n(14),s=function(e){function AadAuthority(t,n){return e.call(this,t,n)||this}return r.__extends(AadAuthority,e),Object.defineProperty(AadAuthority.prototype,"AadInstanceDiscoveryEndpointUrl",{"get":function(){return AadAuthority.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},"enumerable":!0,"configurable":!0}),Object.defineProperty(AadAuthority.prototype,"AuthorityType",{"get":function(){return o.AuthorityType.Aad},"enumerable":!0,"configurable":!0}),AadAuthority.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise(function(t,n){return t(e.DefaultOpenIdConfigurationEndpoint)});if(!this.IsValidationEnabled)return t;var n=this.CanonicalAuthorityUrlComponents.HostNameAndPort;return this.IsInTrustedHostList(n)?t:(new i.XhrClient).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return e.tenant_discovery_endpoint})},AadAuthority.prototype.IsInTrustedHostList=function(e){return AadAuthority.TrustedHostList[e.toLowerCase()]},AadAuthority.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",AadAuthority.TrustedHostList={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},AadAuthority}(o.Authority);t.AadAuthority=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(0),o=function(){function User(e,t,n,r,o,i){this.displayableId=e,this.name=t,this.identityProvider=n,this.userIdentifier=r,this.idToken=o,this.sid=i}return User.createUser=function(e,t){var n,o;t?(n=t.uid,o=t.utid):(n="",o="");var i=r.Utils.base64EncodeStringUrlSafe(n)+"."+r.Utils.base64EncodeStringUrlSafe(o);return new User(e.preferredName,e.name,e.issuer,i,e.decodedIdToken,e.sid)},User}();t.User=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=function(){return function TokenResponse(){this.valid=!1,this.parameters={},this.stateMatch=!1,this.stateResponse="",this.requestType="unknown"}}();t.TokenResponse=r},function(e,t,n){e.exports=n(8)(4)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(33);t.UserAgentApplication=r.UserAgentApplication;var o=n(11);t.Logger=o.Logger;var i=n(11);t.LogLevel=i.LogLevel;var s=n(16);t.User=s.User;var a=n(7);t.Constants=a.Constants;var c=n(17);t.TokenResponse=c.TokenResponse;var u=n(6);t.Authority=u.Authority},function(e,t,n){"use strict";function createThunkMiddleware(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(o){return"function"==typeof o?o(n,r,e):t(o)}}}}t.__esModule=!0;var r=createThunkMiddleware();r.withExtraArgument=createThunkMiddleware,t.default=r},function(e,t,n){"use strict";n.r(t);n(42);var r=n(3),o=n.n(r),i=n(2),s=n.n(i),a=n(13),c=n(1),u=n(20),l=n.n(u),p=n(5),d=n(12),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h={"num":0};var g=Object(c.combineReducers)({"counter":function counter_counter(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;switch(arguments[1].type){case p.a:return f({},e,{"num":e.num+1});case p.d:return f({},e,{"num":e.num-1});case p.b:return d.a.login(),e;case p.c:return d.a.logout(),e;default:return e}}}),m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y="object"===("undefined"==typeof window?"undefined":m(window))&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):c.compose,v=[l.a];var b=y(c.applyMiddleware.apply(void 0,v));n(23);var w=n(18),_=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();o.a.initPxTransform({"designWidth":750,"deviceRatio":{"640":1.17,"750":1,"828":.905}});var C=function configStore(){return Object(c.createStore)(g,b)}(),I=function(e){function App(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,App);var e=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(App.__proto__||Object.getPrototypeOf(App)).apply(this,arguments));return e.config={"pages":["pages/index/index","pages/identified/index"],"window":{"backgroundTextStyle":"light","navigationBarBackgroundColor":"#fff","navigationBarTitleText":"WeChat","navigationBarTextStyle":"black"}},o.a._set$app(e),e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(App,r["Component"]),_(App,[{"key":"componentDidMount","value":function componentDidMount(){this.componentDidShow()}},{"key":"componentDidShow","value":function componentDidShow(){}},{"key":"componentDidHide","value":function componentDidHide(){}},{"key":"componentCatchError","value":function componentCatchError(){}},{"key":"componentDidCatchError","value":function componentDidCatchError(){}},{"key":"render","value":function render(){return s.a.createElement(a.Provider,{"store":C},s.a.createElement(w.Router,{"mode":"browser","publicPath":"/me","routes":[{"path":"/pages/index/index","componentLoader":function componentLoader(){return Promise.all([n.e(0),n.e(1),n.e(3)]).then(n.bind(null,105))},"isIndex":!0},{"path":"/pages/identified/index","componentLoader":function componentLoader(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,106))},"isIndex":!1}],"customRoutes":{},"basename":"/me"}))}},{"key":"componentWillUnmount","value":function componentWillUnmount(){this.componentDidHide()}}]),App}();s.a.render(s.a.createElement(I,null),document.getElementById("app"))},,function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(9),o=n(15),i=n(6),s=n(10),a=n(0),c=function(e){function B2cAuthority(t,n){var r=e.call(this,t,n)||this,o=a.Utils.GetUrlComponents(t),i=o.PathSegments;if(i.length<3)throw s.ErrorMessage.b2cAuthorityUriInvalidPath;return r.CanonicalAuthority="https://"+o.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",r}return r.__extends(B2cAuthority,e),Object.defineProperty(B2cAuthority.prototype,"AuthorityType",{"get":function(){return i.AuthorityType.B2C},"enumerable":!0,"configurable":!0}),B2cAuthority.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise(function(t,n){return t(e.DefaultOpenIdConfigurationEndpoint)});return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?t:new Promise(function(e,t){return t(s.ErrorMessage.unsupportedAuthorityValidation)}):t},B2cAuthority}(o.AadAuthority);t.B2cAuthority=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(0),o=n(15),i=n(24),s=n(6),a=n(10),c=function(){function AuthorityFactory(){}return AuthorityFactory.DetectAuthorityFromUrl=function(e){switch(e=r.Utils.CanonicalizeUri(e),r.Utils.GetUrlComponents(e).PathSegments[0]){case"tfp":return s.AuthorityType.B2C;case"adfs":return s.AuthorityType.Adfs;default:return s.AuthorityType.Aad}},AuthorityFactory.CreateInstance=function(e,t){if(r.Utils.isEmpty(e))return null;switch(AuthorityFactory.DetectAuthorityFromUrl(e)){case s.AuthorityType.B2C:return new i.B2cAuthority(e,t);case s.AuthorityType.Aad:return new o.AadAuthority(e,t);default:throw a.ErrorMessage.invalidAuthorityType}},AuthorityFactory}();t.AuthorityFactory=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=function(){return function AccessTokenCacheItem(e,t){this.key=e,this.value=t}}();t.AccessTokenCacheItem=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(7),o=n(26),i=function(){function Storage(e){if(Storage._instance)return Storage._instance;if(this._cacheLocation=e,this._localStorageSupported=void 0!==window[this._cacheLocation]&&null!=window[this._cacheLocation],this._sessionStorageSupported=void 0!==window[e]&&null!=window[e],Storage._instance=this,!this._localStorageSupported&&!this._sessionStorageSupported)throw new Error("localStorage and sessionStorage not supported");return Storage._instance}return Storage.prototype.setItem=function(e,t,n){window[this._cacheLocation]&&window[this._cacheLocation].setItem(e,t),n&&this.setItemCookie(e,t)},Storage.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this._cacheLocation]?window[this._cacheLocation].getItem(e):null},Storage.prototype.removeItem=function(e){if(window[this._cacheLocation])return window[this._cacheLocation].removeItem(e)},Storage.prototype.clear=function(){if(window[this._cacheLocation])return window[this._cacheLocation].clear()},Storage.prototype.getAllAccessTokens=function(e,t){var n,r=[],i=window[this._cacheLocation];if(i){var s=void 0;for(s in i)if(i.hasOwnProperty(s)&&s.match(e)&&s.match(t)){var a=this.getItem(s);a&&(n=new o.AccessTokenCacheItem(JSON.parse(s),JSON.parse(a)),r.push(n))}}return r},Storage.prototype.removeAcquireTokenEntries=function(e,t){var n=window[this._cacheLocation];if(n){var r=void 0;for(r in n)n.hasOwnProperty(r)&&(""!==e&&r.indexOf(e)>-1||""!==t&&r.indexOf(t)>-1)&&this.removeItem(r)}},Storage.prototype.resetCacheItems=function(){var e=window[this._cacheLocation];if(e){var t=void 0;for(t in e)e.hasOwnProperty(t)&&(-1!==t.indexOf(r.Constants.msal)&&this.setItem(t,""),-1!==t.indexOf(r.Constants.renewStatus)&&this.removeItem(t))}},Storage.prototype.setItemCookie=function(e,t,n){var r=e+"="+t+";";n&&(r+="expires="+this.setExpirationCookie(n)+";");document.cookie=r},Storage.prototype.getItemCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},Storage.prototype.setExpirationCookie=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},Storage.prototype.clearCookie=function(){this.setItemCookie(r.Constants.nonceIdToken,"",-1),this.setItemCookie(r.Constants.stateLogin,"",-1),this.setItemCookie(r.Constants.loginRequest,"",-1),this.setItemCookie(r.Constants.stateAcquireToken,"",-1)},Storage}();t.Storage=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(0),o=function(){return function IdToken(e){if(r.Utils.isEmpty(e))throw new Error("null or empty raw idtoken");try{this.rawIdToken=e,this.decodedIdToken=r.Utils.extractIdToken(e),this.decodedIdToken&&(this.decodedIdToken.hasOwnProperty("iss")&&(this.issuer=this.decodedIdToken.iss),this.decodedIdToken.hasOwnProperty("oid")&&(this.objectId=this.decodedIdToken.oid),this.decodedIdToken.hasOwnProperty("sub")&&(this.subject=this.decodedIdToken.sub),this.decodedIdToken.hasOwnProperty("tid")&&(this.tenantId=this.decodedIdToken.tid),this.decodedIdToken.hasOwnProperty("ver")&&(this.version=this.decodedIdToken.ver),this.decodedIdToken.hasOwnProperty("preferred_username")&&(this.preferredName=this.decodedIdToken.preferred_username),this.decodedIdToken.hasOwnProperty("name")&&(this.name=this.decodedIdToken.name),this.decodedIdToken.hasOwnProperty("nonce")&&(this.nonce=this.decodedIdToken.nonce),this.decodedIdToken.hasOwnProperty("exp")&&(this.expiration=this.decodedIdToken.exp),this.decodedIdToken.hasOwnProperty("home_oid")&&(this.homeObjectId=this.decodedIdToken.home_oid),this.decodedIdToken.hasOwnProperty("sid")&&(this.sid=this.decodedIdToken.sid))}catch(e){throw new Error("Failed to parse the returned id token")}}}();t.IdToken=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(0),o=function(){function ClientInfo(e){if(!e||r.Utils.isEmpty(e))return this.uid="",void(this.utid="");try{var t=r.Utils.base64DecodeStringUrlSafe(e),n=JSON.parse(t);n&&(n.hasOwnProperty("uid")&&(this.uid=n.uid),n.hasOwnProperty("utid")&&(this.utid=n.utid))}catch(e){throw new Error(e)}}return Object.defineProperty(ClientInfo.prototype,"uid",{"get":function(){return this._uid?this._uid:""},"set":function(e){this._uid=e},"enumerable":!0,"configurable":!0}),Object.defineProperty(ClientInfo.prototype,"utid",{"get":function(){return this._utid?this._utid:""},"set":function(e){this._utid=e},"enumerable":!0,"configurable":!0}),ClientInfo}();t.ClientInfo=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(0),o=function(){function AuthenticationRequestParameters(e,t,n,o,i,s){this.authorityInstance=e,this.clientId=t,this.scopes=n,this.responseType=o,this.redirectUri=i,this.correlationId=r.Utils.createNewGuid(),this.state=s&&!r.Utils.isEmpty(s)?r.Utils.createNewGuid()+"|"+s:r.Utils.createNewGuid(),this.nonce=r.Utils.createNewGuid(),this.xClientSku="MSAL.JS",this.xClientVer=r.Utils.getLibraryVersion()}return Object.defineProperty(AuthenticationRequestParameters.prototype,"authority",{"get":function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},"enumerable":!0,"configurable":!0}),AuthenticationRequestParameters.prototype.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),n=this.authorityInstance.AuthorizationEndpoint;return n.indexOf("?")<0?n+="?":n+="&",""+n+t.join("&")},AuthenticationRequestParameters.prototype.createNavigationUrlString=function(e){e||(e=[this.clientId]),-1===e.indexOf(this.clientId)&&e.push(this.clientId);var t=[];return t.push("response_type="+this.responseType),this.translateclientIdUsedInScope(e),t.push("scope="+encodeURIComponent(this.parseScope(e))),t.push("client_id="+encodeURIComponent(this.clientId)),t.push("redirect_uri="+encodeURIComponent(this.redirectUri)),t.push("state="+encodeURIComponent(this.state)),t.push("nonce="+encodeURIComponent(this.nonce)),t.push("client_info=1"),t.push("x-client-SKU="+this.xClientSku),t.push("x-client-Ver="+this.xClientVer),this.extraQueryParameters&&t.push(this.extraQueryParameters),t.push("client-request-id="+encodeURIComponent(this.correlationId)),t},AuthenticationRequestParameters.prototype.translateclientIdUsedInScope=function(e){var t=e.indexOf(this.clientId);t>=0&&(e.splice(t,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},AuthenticationRequestParameters.prototype.parseScope=function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=n!==e.length-1?e[n]+" ":e[n];return t},AuthenticationRequestParameters}();t.AuthenticationRequestParameters=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=function(){return function AccessTokenValue(e,t,n,r){this.accessToken=e,this.idToken=t,this.expiresIn=n,this.clientInfo=r}}();t.AccessTokenValue=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(0),o=function(){return function AccessTokenKey(e,t,n,o,i){this.authority=e,this.clientId=t,this.scopes=n,this.userIdentifier=r.Utils.base64EncodeStringUrlSafe(o)+"."+r.Utils.base64EncodeStringUrlSafe(i)}}();t.AccessTokenKey=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0});var r=n(9),o=n(32),i=n(31),s=n(30),a=n(29),c=n(7),u=n(28),l=n(11),p=n(27),d=n(17),f=n(16),h=n(0),g=n(25),m="id_token",y="token",v="id_token token",b=function(e,t,n){var r=n.value;return n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isInIframe()?new Promise(function(){}):r.apply(this,e)},n},w=function(){function UserAgentApplication(e,t,n,r){void 0===r&&(r={}),this._cacheLocations={"localStorage":"localStorage","sessionStorage":"sessionStorage"},this._clockSkew=300,this._tokenReceivedCallback=null,this._isAngular=!1;var o=r.validateAuthority,i=void 0===o||o,s=r.cacheLocation,a=void 0===s?"sessionStorage":s,u=r.redirectUri,d=void 0===u?function(){return window.location.href.split("?")[0].split("#")[0]}:u,f=r.postLogoutRedirectUri,h=void 0===f?function(){return window.location.href.split("?")[0].split("#")[0]}:f,g=r.logger,m=void 0===g?new l.Logger(null):g,y=r.loadFrameTimeout,v=void 0===y?6e3:y,b=r.navigateToLoginRequestUrl,w=void 0===b||b,_=r.state,C=void 0===_?"":_,I=r.isAngular,P=void 0!==I&&I,S=r.unprotectedResources,k=void 0===S?new Array:S,A=r.protectedResourceMap,T=void 0===A?new Map:A,E=r.storeAuthStateInCookie,U=void 0!==E&&E;if(this.loadFrameTimeout=v,this.clientId=e,this.validateAuthority=i,this.authority=t||"https://login.microsoftonline.com/common",this._tokenReceivedCallback=n,this._redirectUri=d,this._postLogoutredirectUri=h,this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._cacheLocation=a,this._navigateToLoginRequestUrl=w,this._state=C,this._isAngular=P,this._unprotectedResources=k,this._protectedResourceMap=T,!this._cacheLocations[a])throw new Error("Cache Location is not valid. Provided value:"+this._cacheLocation+".Possible values are: "+this._cacheLocations.localStorage+", "+this._cacheLocations.sessionStorage);this._cacheStorage=new p.Storage(this._cacheLocation),this._logger=m,this.storeAuthStateInCookie=U,window.openedWindows=[],window.activeRenewals={},window.renewStates=[],window.callBackMappedToRenewStates={},window.callBacksMappedToRenewStates={},window.msal=this;var O=window.location.hash,x=this.isCallback(O);if(!this._isAngular)if(x)this.handleAuthenticationResponse.call(this,O);else{var R=this._cacheStorage.getItem(c.Constants.urlHash);R&&this.processCallBack(R)}}return Object.defineProperty(UserAgentApplication.prototype,"cacheLocation",{"get":function(){return this._cacheLocation},"enumerable":!0,"configurable":!0}),Object.defineProperty(UserAgentApplication.prototype,"authority",{"get":function(){return this.authorityInstance.CanonicalAuthority},"set":function(e){this.authorityInstance=g.AuthorityFactory.CreateInstance(e,this.validateAuthority)},"enumerable":!0,"configurable":!0}),UserAgentApplication.prototype.processCallBack=function(e){this._logger.info("Processing the callback from redirect response");var t=this.getRequestInfo(e);this.saveTokenFromHash(t);var n,r=t.parameters[c.Constants.accessToken]||t.parameters[c.Constants.idToken],o=t.parameters[c.Constants.errorDescription],i=t.parameters[c.Constants.error];n=t.parameters[c.Constants.accessToken]?c.Constants.accessToken:c.Constants.idToken,this._cacheStorage.removeItem(c.Constants.urlHash);try{this._tokenReceivedCallback&&(this._cacheStorage.clearCookie(),this._tokenReceivedCallback.call(this,o,r,i,n,this.getUserState(this._cacheStorage.getItem(c.Constants.stateLogin,this.storeAuthStateInCookie))))}catch(e){this._logger.error("Error occurred in token received callback function: "+e)}},UserAgentApplication.prototype.getRedirectUri=function(){return"function"==typeof this._redirectUri?this._redirectUri():this._redirectUri},UserAgentApplication.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this._postLogoutredirectUri?this._postLogoutredirectUri():this._postLogoutredirectUri},UserAgentApplication.prototype.loginRedirect=function(e,t){var n=this;if(this._loginInProgress&&this._tokenReceivedCallback)this._tokenReceivedCallback(c.ErrorDescription.loginProgressError,null,c.ErrorCodes.loginProgressError,c.Constants.idToken,this.getUserState(this._cacheStorage.getItem(c.Constants.stateLogin,this.storeAuthStateInCookie)));else{if(e){var r=this.validateInputScope(e);if(r&&!h.Utils.isEmpty(r)&&this._tokenReceivedCallback)return void this._tokenReceivedCallback(c.ErrorDescription.inputScopesError,null,c.ErrorCodes.inputScopesError,c.Constants.idToken,this.getUserState(this._cacheStorage.getItem(c.Constants.stateLogin,this.storeAuthStateInCookie)));e=this.filterScopes(e)}var o;(o=this.extractADALIdToken())&&!e?(this._logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken "),t=h.Utils.constructUnifiedCacheExtraQueryParameter(o,t),this._silentLogin=!0,this.acquireTokenSilent([this.clientId],this.authority,this.getUser(),t).then(function(e){n._silentLogin=!1,n._logger.info("Unified cache call is successful"),n._tokenReceivedCallback&&n._tokenReceivedCallback.call(n,null,e,null,c.Constants.idToken,n.getUserState(n._silentAuthenticationState))},function(r){n._silentLogin=!1,n._logger.error("Error occurred during unified cache ATS"),n.loginRedirectHelper(e,t)})):this.loginRedirectHelper(e,t)}},UserAgentApplication.prototype.loginRedirectHelper=function(e,t){var n=this;this._loginInProgress=!0,this.authorityInstance.ResolveEndpointsAsync().then(function(){var r=new s.AuthenticationRequestParameters(n.authorityInstance,n.clientId,e,m,n.getRedirectUri(),n._state);t&&(r.extraQueryParameters=t);var o=n._cacheStorage.getItem(c.Constants.angularLoginRequest);o&&""!==o?n._cacheStorage.setItem(c.Constants.angularLoginRequest,""):o=window.location.href,n._cacheStorage.setItem(c.Constants.loginRequest,o,n.storeAuthStateInCookie),n._cacheStorage.setItem(c.Constants.loginError,""),n._cacheStorage.setItem(c.Constants.stateLogin,r.state,n.storeAuthStateInCookie),n._cacheStorage.setItem(c.Constants.nonceIdToken,r.nonce,n.storeAuthStateInCookie),n._cacheStorage.setItem(c.Constants.msalError,""),n._cacheStorage.setItem(c.Constants.msalErrorDescription,"");var i=c.Constants.authority+c.Constants.resourceDelimeter+r.state;n._cacheStorage.setItem(i,n.authority,n.storeAuthStateInCookie);var a=r.createNavigateUrl(e)+c.Constants.response_mode_fragment;n.promptUser(a)})},UserAgentApplication.prototype.loginPopup=function(e,t){var n=this;return new Promise(function(r,o){if(n._loginInProgress)o(c.ErrorCodes.loginProgressError+c.Constants.resourceDelimeter+c.ErrorDescription.loginProgressError);else{if(e){var i=n.validateInputScope(e);if(i&&!h.Utils.isEmpty(i))return void o(c.ErrorCodes.inputScopesError+c.Constants.resourceDelimeter+c.ErrorDescription.inputScopesError);e=n.filterScopes(e)}var s;(s=n.extractADALIdToken())&&!e?(n._logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken "),t=h.Utils.constructUnifiedCacheExtraQueryParameter(s,t),n._silentLogin=!0,n.acquireTokenSilent([n.clientId],n.authority,n.getUser(),t).then(function(e){n._silentLogin=!1,n._logger.info("Unified cache call is successful"),r(e)},function(i){n._silentLogin=!1,n._logger.error("Error occurred during unified cache ATS"),n.loginPopupHelper(r,o,e,t)})):n.loginPopupHelper(r,o,e,t)}})},UserAgentApplication.prototype.loginPopupHelper=function(e,t,n,r){var o=this;n||(n=[this.clientId]);var i=n.join(" ").toLowerCase(),a=this.openWindow("about:blank","_blank",1,this,e,t);a&&(this._loginInProgress=!0,this.authorityInstance.ResolveEndpointsAsync().then(function(){var u=new s.AuthenticationRequestParameters(o.authorityInstance,o.clientId,n,m,o.getRedirectUri(),o._state);r&&(u.extraQueryParameters=r),o._cacheStorage.setItem(c.Constants.loginRequest,window.location.href,o.storeAuthStateInCookie),o._cacheStorage.setItem(c.Constants.loginError,""),o._cacheStorage.setItem(c.Constants.nonceIdToken,u.nonce,o.storeAuthStateInCookie),o._cacheStorage.setItem(c.Constants.msalError,""),o._cacheStorage.setItem(c.Constants.msalErrorDescription,"");var l=c.Constants.authority+c.Constants.resourceDelimeter+u.state;o._cacheStorage.setItem(l,o.authority,o.storeAuthStateInCookie);var p=u.createNavigateUrl(n)+c.Constants.response_mode_fragment;window.renewStates.push(u.state),window.requestType=c.Constants.login,o.registerCallback(u.state,i,e,t),a&&(o._logger.infoPii("Navigated Popup window to:"+p),a.location.href=p)},function(){o._logger.info(c.ErrorCodes.endpointResolutionError+":"+c.ErrorDescription.endpointResolutionError),o._cacheStorage.setItem(c.Constants.msalError,c.ErrorCodes.endpointResolutionError),o._cacheStorage.setItem(c.Constants.msalErrorDescription,c.ErrorDescription.endpointResolutionError),t&&t(c.ErrorCodes.endpointResolutionError+":"+c.ErrorDescription.endpointResolutionError),a&&a.close()}).catch(function(e){o._logger.warning("could not resolve endpoints"),t(e)}))},UserAgentApplication.prototype.promptUser=function(e){e&&!h.Utils.isEmpty(e)?(this._logger.infoPii("Navigate to:"+e),window.location.replace(e)):this._logger.info("Navigate url is empty")},UserAgentApplication.prototype.openWindow=function(e,t,n,r,o,i){var s=this,a=this.openPopup(e,t,c.Constants.popUpWidth,c.Constants.popUpHeight);if(null==a)return r._loginInProgress=!1,r._acquireTokenInProgress=!1,this._logger.info(c.ErrorCodes.popUpWindowError+":"+c.ErrorDescription.popUpWindowError),this._cacheStorage.setItem(c.Constants.msalError,c.ErrorCodes.popUpWindowError),this._cacheStorage.setItem(c.Constants.msalErrorDescription,c.ErrorDescription.popUpWindowError),i&&i(c.ErrorCodes.popUpWindowError+c.Constants.resourceDelimeter+c.ErrorDescription.popUpWindowError),null;window.openedWindows.push(a);var u=window.setInterval(function(){if(a&&a.closed&&r._loginInProgress){if(i&&i(c.ErrorCodes.userCancelledError+c.Constants.resourceDelimeter+c.ErrorDescription.userCancelledError),window.clearInterval(u),s._isAngular)return void s.broadcast("msal:popUpClosed",c.ErrorCodes.userCancelledError+c.Constants.resourceDelimeter+c.ErrorDescription.userCancelledError);r._loginInProgress=!1,r._acquireTokenInProgress=!1}try{var e=a.location;if(-1!==e.href.indexOf(s.getRedirectUri())&&(window.clearInterval(u),r._loginInProgress=!1,r._acquireTokenInProgress=!1,s._logger.info("Closing popup window"),s._isAngular)){s.broadcast("msal:popUpHashChanged",e.hash);for(var t=0;t<window.openedWindows.length;t++)window.openedWindows[t].close()}}catch(e){}},n);return a},UserAgentApplication.prototype.broadcast=function(e,t){var n=new CustomEvent(e,{"detail":t});window.dispatchEvent(n)},UserAgentApplication.prototype.logout=function(){this.clearCache(),this._user=null;var e="";this.getPostLogoutRedirectUri()&&(e="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()));var t=this.authority+"/oauth2/v2.0/logout?"+e;this.promptUser(t)},UserAgentApplication.prototype.clearCache=function(){window.renewStates=[];for(var e=this._cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.userIdentifier),t=0;t<e.length;t++)this._cacheStorage.removeItem(JSON.stringify(e[t].key));this._cacheStorage.resetCacheItems(),this._cacheStorage.clearCookie()},UserAgentApplication.prototype.clearCacheForScope=function(e){for(var t=this._cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.userIdentifier),n=0;n<t.length;n++){var r=t[n];r.value.accessToken===e&&this._cacheStorage.removeItem(JSON.stringify(r.key))}},UserAgentApplication.prototype.openPopup=function(e,t,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=s/2-n/2+o,u=a/2-r/2+i,l=window.open(e,t,"width="+n+", height="+r+", top="+u+", left="+c);return l.focus&&l.focus(),l}catch(e){return this._logger.error("error opening popup "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},UserAgentApplication.prototype.validateInputScope=function(e){if(!e||e.length<1)return"Scopes cannot be passed as an empty array";if(!Array.isArray(e))throw new Error("API does not accept non-array scopes");return e.indexOf(this.clientId)>-1&&e.length>1?"ClientId can only be provided as a single scope":""},UserAgentApplication.prototype.filterScopes=function(e){return e=(e=e.filter(function(e){return"openid"!==e})).filter(function(e){return"profile"!==e})},UserAgentApplication.prototype.registerCallback=function(e,t,n,r){var o=this;window.activeRenewals[t]=e,window.callBacksMappedToRenewStates[e]||(window.callBacksMappedToRenewStates[e]=[]),window.callBacksMappedToRenewStates[e].push({"resolve":n,"reject":r}),window.callBackMappedToRenewStates[e]||(window.callBackMappedToRenewStates[e]=function(n,r,i,s){window.activeRenewals[t]=null;for(var a=0;a<window.callBacksMappedToRenewStates[e].length;++a)try{n||i?window.callBacksMappedToRenewStates[e][a].reject(n+c.Constants.resourceDelimeter+i):r&&window.callBacksMappedToRenewStates[e][a].resolve(r)}catch(e){o._logger.warning(e)}window.callBacksMappedToRenewStates[e]=null,window.callBackMappedToRenewStates[e]=null})},UserAgentApplication.prototype.getCachedTokenInternal=function(e,t){var n,r=t||this.getUser();if(!r)return null;var o=this.authorityInstance?this.authorityInstance:g.AuthorityFactory.CreateInstance(this.authority,this.validateAuthority);return n=h.Utils.compareObjects(r,this.getUser())?e.indexOf(this.clientId)>-1?new s.AuthenticationRequestParameters(o,this.clientId,e,m,this.getRedirectUri(),this._state):new s.AuthenticationRequestParameters(o,this.clientId,e,y,this.getRedirectUri(),this._state):new s.AuthenticationRequestParameters(o,this.clientId,e,v,this.getRedirectUri(),this._state),this.getCachedToken(n,t)},UserAgentApplication.prototype.getCachedToken=function(e,t){var n=null,r=e.scopes,o=this._cacheStorage.getAllAccessTokens(this.clientId,t?t.userIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(s=0;s<o.length;s++){c=(a=o[s]).key.scopes.split(" ");h.Utils.containsScope(c,r)&&a.key.authority===e.authority&&i.push(a)}if(0===i.length)return null;if(1!==i.length)return{"errorDesc":"The cache contains multiple tokens satisfying the requirements.Call AcquireToken again providing more requirements like authority","token":null,"error":"multiple_matching_tokens_detected"};n=i[0]}else{for(var s=0;s<o.length;s++){var a,c=(a=o[s]).key.scopes.split(" ");h.Utils.containsScope(c,r)&&i.push(a)}if(1===i.length)n=i[0],e.authorityInstance=g.AuthorityFactory.CreateInstance(n.key.authority,this.validateAuthority);else{if(i.length>1)return{"errorDesc":"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority","token":null,"error":"multiple_matching_tokens_detected"};var u=this.getUniqueAuthority(o,"authority");if(u.length>1)return{"errorDesc":"Multiple authorities found in the cache. Pass authority in the API overload.","token":null,"error":"multiple_matching_tokens_detected"};e.authorityInstance=g.AuthorityFactory.CreateInstance(u[0],this.validateAuthority)}}if(null!=n){var l=Number(n.value.expiresIn),p=this._clockSkew||300;return l&&l>h.Utils.now()+p?{"errorDesc":null,"token":n.value.accessToken,"error":null}:(this._cacheStorage.removeItem(JSON.stringify(i[0].key)),null)}return null},UserAgentApplication.prototype.getAllUsers=function(){for(var e=[],t=this._cacheStorage.getAllAccessTokens(c.Constants.clientId,c.Constants.userIdentifier),n=0;n<t.length;n++){var r=new u.IdToken(t[n].value.idToken),o=new a.ClientInfo(t[n].value.clientInfo),i=f.User.createUser(r,o);e.push(i)}return this.getUniqueUsers(e)},UserAgentApplication.prototype.getUniqueUsers=function(e){if(!e||e.length<=1)return e;for(var t=[],n=[],r=0;r<e.length;++r)e[r].userIdentifier&&-1===t.indexOf(e[r].userIdentifier)&&(t.push(e[r].userIdentifier),n.push(e[r]));return n},UserAgentApplication.prototype.getUniqueAuthority=function(e,t){var n=[],r=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===r.indexOf(e.key[t])&&(r.push(e.key[t]),n.push(e.key[t]))}),n},UserAgentApplication.prototype.addHintParameters=function(e,t){var n=t||this.getUser();if(n){var r=n.userIdentifier.split("."),o=h.Utils.base64DecodeStringUrlSafe(r[0]),i=h.Utils.base64DecodeStringUrlSafe(r[1]);n.sid&&-1!==e.indexOf(c.Constants.prompt_none)?this.urlContainsQueryStringParameter(c.Constants.sid,e)||this.urlContainsQueryStringParameter(c.Constants.login_hint,e)||(e+="&"+c.Constants.sid+"="+encodeURIComponent(n.sid)):this.urlContainsQueryStringParameter(c.Constants.login_hint,e)||!n.displayableId||h.Utils.isEmpty(n.displayableId)||(e+="&"+c.Constants.login_hint+"="+encodeURIComponent(n.displayableId)),h.Utils.isEmpty(o)||h.Utils.isEmpty(i)||(this.urlContainsQueryStringParameter("domain_req",e)||h.Utils.isEmpty(i)||(e+="&domain_req="+encodeURIComponent(i)),this.urlContainsQueryStringParameter("login_req",e)||h.Utils.isEmpty(o)||(e+="&login_req="+encodeURIComponent(o))),this.urlContainsQueryStringParameter(c.Constants.domain_hint,e)||h.Utils.isEmpty(i)||(i===c.Constants.consumersUtid?e+="&"+c.Constants.domain_hint+"="+encodeURIComponent(c.Constants.consumers):e+="&"+c.Constants.domain_hint+"="+encodeURIComponent(c.Constants.organizations))}return e},UserAgentApplication.prototype.urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},UserAgentApplication.prototype.acquireTokenRedirect=function(e,t,n,r){var o=this,i=this.validateInputScope(e);if(i&&!h.Utils.isEmpty(i)&&this._tokenReceivedCallback)this._tokenReceivedCallback(c.ErrorDescription.inputScopesError,null,c.ErrorCodes.inputScopesError,c.Constants.accessToken,this.getUserState(this._cacheStorage.getItem(c.Constants.stateLogin,this.storeAuthStateInCookie)));else{e&&(e=this.filterScopes(e));var a=n||this.getUser();if(!this._acquireTokenInProgress){var u;e.join(" ").toLowerCase();if(!(a||r&&-1!==r.indexOf(c.Constants.login_hint))&&this._tokenReceivedCallback)return this._logger.info("User login is required"),void this._tokenReceivedCallback(c.ErrorDescription.userLoginError,null,c.ErrorCodes.userLoginError,c.Constants.accessToken,this.getUserState(this._cacheStorage.getItem(c.Constants.stateLogin,this.storeAuthStateInCookie)));this._acquireTokenInProgress=!0;var l=t?g.AuthorityFactory.CreateInstance(t,this.validateAuthority):this.authorityInstance;l.ResolveEndpointsAsync().then(function(){var t;u=h.Utils.compareObjects(a,o.getUser())?e.indexOf(o.clientId)>-1?new s.AuthenticationRequestParameters(l,o.clientId,e,m,o.getRedirectUri(),o._state):new s.AuthenticationRequestParameters(l,o.clientId,e,y,o.getRedirectUri(),o._state):new s.AuthenticationRequestParameters(l,o.clientId,e,v,o.getRedirectUri(),o._state),o._cacheStorage.setItem(c.Constants.nonceIdToken,u.nonce,o.storeAuthStateInCookie),t=a?c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+a.userIdentifier+c.Constants.resourceDelimeter+u.state:c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+c.Constants.no_user+c.Constants.resourceDelimeter+u.state,o._cacheStorage.setItem(t,JSON.stringify(a));var n=c.Constants.authority+c.Constants.resourceDelimeter+u.state;o._cacheStorage.setItem(n,l.CanonicalAuthority,o.storeAuthStateInCookie),r&&(u.extraQueryParameters=r);var i=u.createNavigateUrl(e)+c.Constants.response_mode_fragment;(i=o.addHintParameters(i,a))&&(o._cacheStorage.setItem(c.Constants.stateAcquireToken,u.state,o.storeAuthStateInCookie),window.location.replace(i))})}}},UserAgentApplication.prototype.acquireTokenPopup=function(e,t,n,r){var o=this;return new Promise(function(i,a){var u=o.validateInputScope(e);u&&!h.Utils.isEmpty(u)&&a(c.ErrorCodes.inputScopesError+c.Constants.resourceDelimeter+u),e&&(e=o.filterScopes(e));var l=n||o.getUser();if(o._acquireTokenInProgress)a(c.ErrorCodes.acquireTokenProgressError+c.Constants.resourceDelimeter+c.ErrorDescription.acquireTokenProgressError);else{var p,d=e.join(" ").toLowerCase();if(!(l||r&&-1!==r.indexOf(c.Constants.login_hint)))return o._logger.info("User login is required"),void a(c.ErrorCodes.userLoginError+c.Constants.resourceDelimeter+c.ErrorDescription.userLoginError);o._acquireTokenInProgress=!0;var f=t?g.AuthorityFactory.CreateInstance(t,o.validateAuthority):o.authorityInstance,b=o.openWindow("about:blank","_blank",1,o,i,a);b&&f.ResolveEndpointsAsync().then(function(){var t;p=h.Utils.compareObjects(l,o.getUser())?e.indexOf(o.clientId)>-1?new s.AuthenticationRequestParameters(f,o.clientId,e,m,o.getRedirectUri(),o._state):new s.AuthenticationRequestParameters(f,o.clientId,e,y,o.getRedirectUri(),o._state):new s.AuthenticationRequestParameters(f,o.clientId,e,v,o.getRedirectUri(),o._state),o._cacheStorage.setItem(c.Constants.nonceIdToken,p.nonce),p.state=p.state,t=l?c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+l.userIdentifier+c.Constants.resourceDelimeter+p.state:c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+c.Constants.no_user+c.Constants.resourceDelimeter+p.state,o._cacheStorage.setItem(t,JSON.stringify(l));var n=c.Constants.authority+c.Constants.resourceDelimeter+p.state;o._cacheStorage.setItem(n,f.CanonicalAuthority,o.storeAuthStateInCookie),r&&(p.extraQueryParameters=r);var u=p.createNavigateUrl(e)+c.Constants.response_mode_fragment;u=o.addHintParameters(u,l),window.renewStates.push(p.state),window.requestType=c.Constants.renewToken,o.registerCallback(p.state,d,i,a),b&&(b.location.href=u)},function(){o._logger.info(c.ErrorCodes.endpointResolutionError+":"+c.ErrorDescription.endpointResolutionError),o._cacheStorage.setItem(c.Constants.msalError,c.ErrorCodes.endpointResolutionError),o._cacheStorage.setItem(c.Constants.msalErrorDescription,c.ErrorDescription.endpointResolutionError),a&&a(c.ErrorCodes.endpointResolutionError+c.Constants.resourceDelimeter+c.ErrorDescription.endpointResolutionError),b&&b.close()}).catch(function(e){o._logger.warning("could not resolve endpoints"),a(e)})}})},UserAgentApplication.prototype.acquireTokenSilent=function(e,t,n,r){var o=this;return new Promise(function(i,a){var u=o.validateInputScope(e);if(u&&!h.Utils.isEmpty(u))return a(c.ErrorCodes.inputScopesError+"|"+u),null;e&&(e=o.filterScopes(e));var l,p=e.join(" ").toLowerCase(),d=n||o.getUser(),f=o._cacheStorage.getItem(c.Constants.adalIdToken);if(!d&&h.Utils.checkSSO(r)&&h.Utils.isEmpty(f))return o._logger.info("User login is required"),a(c.ErrorCodes.userLoginError+c.Constants.resourceDelimeter+c.ErrorDescription.userLoginError),null;if(!d&&!h.Utils.isEmpty(f)){var b=h.Utils.extractIdToken(f);console.log("ADAL's idToken exists. Extracting login information from ADAL's idToken "),r=h.Utils.constructUnifiedCacheExtraQueryParameter(b,r)}l=h.Utils.compareObjects(d,o.getUser())?e.indexOf(o.clientId)>-1?new s.AuthenticationRequestParameters(g.AuthorityFactory.CreateInstance(t,o.validateAuthority),o.clientId,e,m,o.getRedirectUri(),o._state):new s.AuthenticationRequestParameters(g.AuthorityFactory.CreateInstance(t,o.validateAuthority),o.clientId,e,y,o.getRedirectUri(),o._state):e.indexOf(o.clientId)>-1?new s.AuthenticationRequestParameters(g.AuthorityFactory.CreateInstance(t,o.validateAuthority),o.clientId,e,m,o.getRedirectUri(),o._state):new s.AuthenticationRequestParameters(g.AuthorityFactory.CreateInstance(t,o.validateAuthority),o.clientId,e,v,o.getRedirectUri(),o._state);var w=o.getCachedToken(l,d);if(w){if(w.token)return o._logger.info("Token is already in cache for scope:"+p),i(w.token),null;if(w.errorDesc||w.error)return o._logger.infoPii(w.errorDesc+":"+w.error),a(w.errorDesc+c.Constants.resourceDelimeter+w.error),null}else o._logger.verbose("Token is not in cache for scope:"+p);return l.authorityInstance||(l.authorityInstance=t?g.AuthorityFactory.CreateInstance(t,o.validateAuthority):o.authorityInstance),l.authorityInstance.ResolveEndpointsAsync().then(function(){window.activeRenewals[p]?(o._logger.verbose("Renew token for scope: "+p+" is in progress. Registering callback"),o.registerCallback(window.activeRenewals[p],p,i,a)):e&&e.indexOf(o.clientId)>-1&&1===e.length?(o._logger.verbose("renewing idToken"),o.renewIdToken(e,i,a,d,l,r)):(o._logger.verbose("renewing accesstoken"),o.renewToken(e,i,a,d,l,r))}).catch(function(e){return o._logger.warning("could not resolve endpoints"),a(e),null})})},UserAgentApplication.prototype.extractADALIdToken=function(){var e=this._cacheStorage.getItem(c.Constants.adalIdToken);return h.Utils.isEmpty(e)?null:h.Utils.extractIdToken(e)},UserAgentApplication.prototype.loadIframeTimeout=function(e,t,n){var r=this,o=window.activeRenewals[n];this._logger.verbose("Set loading state to pending for: "+n+":"+o),this._cacheStorage.setItem(c.Constants.renewStatus+o,c.Constants.tokenRenewStatusInProgress),this.loadFrame(e,t),setTimeout(function(){r._cacheStorage.getItem(c.Constants.renewStatus+o)===c.Constants.tokenRenewStatusInProgress&&(r._logger.verbose("Loading frame has timed out after: "+r.loadFrameTimeout/1e3+" seconds for scope "+n+":"+o),o&&window.callBackMappedToRenewStates[o]&&window.callBackMappedToRenewStates[o]("Token renewal operation failed due to timeout",null,"Token Renewal Failed",c.Constants.accessToken),r._cacheStorage.setItem(c.Constants.renewStatus+o,c.Constants.tokenRenewStatusCancelled))},this.loadFrameTimeout)},UserAgentApplication.prototype.loadFrame=function(e,t){var n=this;this._logger.info("LoadFrame: "+t);var r=t;setTimeout(function(){var o=n.addAdalFrame(r);""!==o.src&&"about:blank"!==o.src||(o.src=e,n._logger.infoPii("Frame Name : "+t+" Navigated to: "+e))},500)},UserAgentApplication.prototype.addAdalFrame=function(e){if(void 0===e)return null;this._logger.info("Add msal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},UserAgentApplication.prototype.renewToken=function(e,t,n,r,o,i){var s=e.join(" ").toLowerCase();this._logger.verbose("renewToken is called for scope:"+s);var a,u=this.addAdalFrame("msalRenewFrame"+s);i&&(o.extraQueryParameters=i),a=r?c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+r.userIdentifier+c.Constants.resourceDelimeter+o.state:c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+c.Constants.no_user+c.Constants.resourceDelimeter+o.state,this._cacheStorage.setItem(a,JSON.stringify(r));var l=c.Constants.authority+c.Constants.resourceDelimeter+o.state;this._cacheStorage.setItem(l,o.authority),this._cacheStorage.setItem(c.Constants.nonceIdToken,o.nonce),this._logger.verbose("Renew token Expected state: "+o.state);var p=h.Utils.urlRemoveQueryStringParameter(o.createNavigateUrl(e),c.Constants.prompt)+c.Constants.prompt_none;p=this.addHintParameters(p,r),window.renewStates.push(o.state),window.requestType=c.Constants.renewToken,this.registerCallback(o.state,s,t,n),this._logger.infoPii("Navigate to:"+p),u.src="about:blank",this.loadIframeTimeout(p,"msalRenewFrame"+s,s)},UserAgentApplication.prototype.renewIdToken=function(e,t,n,r,o,i){e.join(" ").toLowerCase();this._logger.info("renewidToken is called");var s,a=this.addAdalFrame("msalIdTokenFrame");i&&(o.extraQueryParameters=i),s=r?c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+r.userIdentifier+c.Constants.resourceDelimeter+o.state:c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+c.Constants.no_user+c.Constants.resourceDelimeter+o.state,this._cacheStorage.setItem(s,JSON.stringify(r));var u=c.Constants.authority+c.Constants.resourceDelimeter+o.state;this._cacheStorage.setItem(u,o.authority),this._cacheStorage.setItem(c.Constants.nonceIdToken,o.nonce),this._logger.verbose("Renew Idtoken Expected state: "+o.state);var l=h.Utils.urlRemoveQueryStringParameter(o.createNavigateUrl(e),c.Constants.prompt)+c.Constants.prompt_none;l=this.addHintParameters(l,r),this._silentLogin?(window.requestType=c.Constants.login,this._silentAuthenticationState=o.state):(window.requestType=c.Constants.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,this.clientId,t,n),this._logger.infoPii("Navigate to:"+l),a.src="about:blank",this.loadIframeTimeout(l,"msalIdTokenFrame",this.clientId)},UserAgentApplication.prototype.getUser=function(){if(this._user)return this._user;var e=this._cacheStorage.getItem(c.Constants.idTokenKey),t=this._cacheStorage.getItem(c.Constants.msalClientInfo);if(!h.Utils.isEmpty(e)&&!h.Utils.isEmpty(t)){var n=new u.IdToken(e),r=new a.ClientInfo(t);return this._user=f.User.createUser(n,r),this._user}return null},UserAgentApplication.prototype.handleAuthenticationResponse=function(e){null==e&&(e=window.location.hash);var t=null,n=!1,r=!1;try{r=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(e){r=!1}r?(t=window.opener.msal,n=!0):window.parent&&window.parent.msal&&(t=window.parent.msal);var o,i=t.getRequestInfo(e),s=null,a=null;if(t._logger.info("Returned from redirect url"),window.parent!==window&&window.parent.msal)a=window.parent.callBackMappedToRenewStates[i.stateResponse];else if(r)a=window.opener.callBackMappedToRenewStates[i.stateResponse];else{if(t._navigateToLoginRequestUrl)return a=null,t._cacheStorage.setItem(c.Constants.urlHash,e),!1,void(window.parent!==window||n||(window.location.href=t._cacheStorage.getItem(c.Constants.loginRequest,this.storeAuthStateInCookie)));a=t._tokenReceivedCallback,window.location.hash=""}t.saveTokenFromHash(i),i.requestType===c.Constants.renewToken&&window.parent?(window.parent!==window?t._logger.verbose("Window is in iframe, acquiring token silently"):t._logger.verbose("acquiring token interactive in progress"),s=i.parameters[c.Constants.accessToken]||i.parameters[c.Constants.idToken],o=c.Constants.accessToken):i.requestType===c.Constants.login&&(s=i.parameters[c.Constants.idToken],o=c.Constants.idToken);var u=i.parameters[c.Constants.errorDescription],l=i.parameters[c.Constants.error];try{a&&(i.stateMatch?a.call(t,u,s,l,o,this.getUserState(i.stateResponse)):a.call(t,u,s,l,o,null))}catch(e){t._logger.error("Error occurred in token received callback function: "+e)}if(r)for(var p=0;p<window.opener.openedWindows.length;p++)window.opener.openedWindows[p].close()},UserAgentApplication.prototype.saveAccessToken=function(e,t,n,r,s){var u,l=new a.ClientInfo(r);if(t.parameters.hasOwnProperty("scope")){for(var p=(u=t.parameters.scope).split(" "),d=this._cacheStorage.getAllAccessTokens(this.clientId,e),f=0;f<d.length;f++){var g=d[f];if(g.key.userIdentifier===n.userIdentifier){var m=g.key.scopes.split(" ");h.Utils.isIntersectingScopes(m,p)&&this._cacheStorage.removeItem(JSON.stringify(g.key))}}var y=new o.AccessTokenKey(e,this.clientId,u,l.uid,l.utid),v=new i.AccessTokenValue(t.parameters[c.Constants.accessToken],s.rawIdToken,h.Utils.expiresIn(t.parameters[c.Constants.expiresIn]).toString(),r);this._cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v))}else{u=this.clientId;y=new o.AccessTokenKey(e,this.clientId,u,l.uid,l.utid),v=new i.AccessTokenValue(t.parameters[c.Constants.idToken],t.parameters[c.Constants.idToken],s.expiration,r);this._cacheStorage.setItem(JSON.stringify(y),JSON.stringify(v))}},UserAgentApplication.prototype.saveTokenFromHash=function(e){this._logger.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._cacheStorage.setItem(c.Constants.msalError,""),this._cacheStorage.setItem(c.Constants.msalErrorDescription,"");var t="",n="";if(e.parameters.hasOwnProperty("scope")?e.parameters.scope.toLowerCase():this.clientId,e.parameters.hasOwnProperty(c.Constants.errorDescription)||e.parameters.hasOwnProperty(c.Constants.error)){if(this._logger.infoPii("Error :"+e.parameters[c.Constants.error]+"; Error description:"+e.parameters[c.Constants.errorDescription]),this._cacheStorage.setItem(c.Constants.msalError,e.parameters.error),this._cacheStorage.setItem(c.Constants.msalErrorDescription,e.parameters[c.Constants.errorDescription]),e.requestType===c.Constants.login&&(this._loginInProgress=!1,this._cacheStorage.setItem(c.Constants.loginError,e.parameters[c.Constants.errorDescription]+":"+e.parameters[c.Constants.error]),t=c.Constants.authority+c.Constants.resourceDelimeter+e.stateResponse),e.requestType===c.Constants.renewToken){this._acquireTokenInProgress=!1,t=c.Constants.authority+c.Constants.resourceDelimeter+e.stateResponse;var r=null!==this.getUser()?this.getUser().userIdentifier:"";n=c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+r+c.Constants.resourceDelimeter+e.stateResponse}}else if(e.stateMatch){var o;this._logger.info("State is right"),e.parameters.hasOwnProperty(c.Constants.sessionState)&&this._cacheStorage.setItem(c.Constants.msalSessionState,e.parameters[c.Constants.sessionState]);var i="";if(e.parameters.hasOwnProperty(c.Constants.accessToken)){this._logger.info("Fragment has access token"),this._acquireTokenInProgress=!1;var s=void 0;o=e.parameters.hasOwnProperty(c.Constants.idToken)?new u.IdToken(e.parameters[c.Constants.idToken]):new u.IdToken(this._cacheStorage.getItem(c.Constants.idTokenKey)),t=c.Constants.authority+c.Constants.resourceDelimeter+e.stateResponse;var l=this._cacheStorage.getItem(t,this.storeAuthStateInCookie);h.Utils.isEmpty(l)||(l=h.Utils.replaceFirstPath(l,o.tenantId)),e.parameters.hasOwnProperty(c.Constants.clientInfo)?(i=e.parameters[c.Constants.clientInfo],s=f.User.createUser(o,new a.ClientInfo(i))):(this._logger.warning("ClientInfo not received in the response from AAD"),s=f.User.createUser(o,new a.ClientInfo(i))),n=c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+s.userIdentifier+c.Constants.resourceDelimeter+e.stateResponse;var p=c.Constants.acquireTokenUser+c.Constants.resourceDelimeter+c.Constants.no_user+c.Constants.resourceDelimeter+e.stateResponse,d=this._cacheStorage.getItem(n),g=void 0;h.Utils.isEmpty(d)?h.Utils.isEmpty(this._cacheStorage.getItem(p))||this.saveAccessToken(l,e,s,i,o):(g=JSON.parse(d),s&&g&&h.Utils.compareObjects(s,g)?(this.saveAccessToken(l,e,s,i,o),this._logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this._logger.warning("The user object created from the response is not the same as the one passed in the acquireToken request"))}if(e.parameters.hasOwnProperty(c.Constants.idToken)){this._logger.info("Fragment has id token"),this._loginInProgress=!1,o=new u.IdToken(e.parameters[c.Constants.idToken]),e.parameters.hasOwnProperty(c.Constants.clientInfo)?i=e.parameters[c.Constants.clientInfo]:this._logger.warning("ClientInfo not received in the response from AAD"),t=c.Constants.authority+c.Constants.resourceDelimeter+e.stateResponse;l=this._cacheStorage.getItem(t,this.storeAuthStateInCookie);h.Utils.isEmpty(l)||(l=h.Utils.replaceFirstPath(l,o.tenantId)),this._user=f.User.createUser(o,new a.ClientInfo(i)),o&&o.nonce?o.nonce!==this._cacheStorage.getItem(c.Constants.nonceIdToken,this.storeAuthStateInCookie)?(this._user=null,this._cacheStorage.setItem(c.Constants.loginError,"Nonce Mismatch. Expected Nonce: "+this._cacheStorage.getItem(c.Constants.nonceIdToken,this.storeAuthStateInCookie)+",Actual Nonce: "+o.nonce),this._logger.error("Nonce Mismatch.Expected Nonce: "+this._cacheStorage.getItem(c.Constants.nonceIdToken,this.storeAuthStateInCookie)+",Actual Nonce: "+o.nonce)):(this._cacheStorage.setItem(c.Constants.idTokenKey,e.parameters[c.Constants.idToken]),this._cacheStorage.setItem(c.Constants.msalClientInfo,i),this.saveAccessToken(l,e,this._user,i,o)):(t=e.stateResponse,n=e.stateResponse,this._logger.error("Invalid id_token received in the response"),e.parameters.error="invalid idToken",e.parameters.error_description="Invalid idToken. idToken: "+e.parameters[c.Constants.idToken],this._cacheStorage.setItem(c.Constants.msalError,"invalid idToken"),this._cacheStorage.setItem(c.Constants.msalErrorDescription,"Invalid idToken. idToken: "+e.parameters[c.Constants.idToken]))}}else t=e.stateResponse,n=e.stateResponse,this._logger.error("State Mismatch.Expected State: "+this._cacheStorage.getItem(c.Constants.stateLogin,this.storeAuthStateInCookie)+",Actual State: "+e.stateResponse),e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._cacheStorage.setItem(c.Constants.msalError,"Invalid_state"),this._cacheStorage.setItem(c.Constants.msalErrorDescription,"Invalid_state. state: "+e.stateResponse);this._cacheStorage.setItem(c.Constants.renewStatus+e.stateResponse,c.Constants.tokenRenewStatusCompleted),this._cacheStorage.removeAcquireTokenEntries(t,n),this.storeAuthStateInCookie&&(this._cacheStorage.setItemCookie(t,"",-1),this._cacheStorage.clearCookie())},UserAgentApplication.prototype.isCallback=function(e){e=this.getHash(e);var t=h.Utils.deserialize(e);return t.hasOwnProperty(c.Constants.errorDescription)||t.hasOwnProperty(c.Constants.error)||t.hasOwnProperty(c.Constants.accessToken)||t.hasOwnProperty(c.Constants.idToken)},UserAgentApplication.prototype.getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},UserAgentApplication.prototype.getRequestInfo=function(e){e=this.getHash(e);var t=h.Utils.deserialize(e),n=new d.TokenResponse;if(t&&(n.parameters=t,t.hasOwnProperty(c.Constants.errorDescription)||t.hasOwnProperty(c.Constants.error)||t.hasOwnProperty(c.Constants.accessToken)||t.hasOwnProperty(c.Constants.idToken))){n.valid=!0;var r=void 0;if(!t.hasOwnProperty("state"))return n;if(r=t.state,n.stateResponse=r,r===this._cacheStorage.getItem(c.Constants.stateLogin,this.storeAuthStateInCookie)||r===this._silentAuthenticationState)return n.requestType=c.Constants.login,n.stateMatch=!0,n;if(r===this._cacheStorage.getItem(c.Constants.stateAcquireToken,this.storeAuthStateInCookie))return n.requestType=c.Constants.renewToken,n.stateMatch=!0,n;if(!n.stateMatch){n.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},UserAgentApplication.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},UserAgentApplication.prototype.getUserState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},UserAgentApplication.prototype.isInIframe=function(){return window.parent!==window},UserAgentApplication.prototype.loginInProgress=function(){return!!this._cacheStorage.getItem(c.Constants.urlHash)||this._loginInProgress},UserAgentApplication.prototype.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},UserAgentApplication.prototype.getScopesForEndpoint=function(e){if(this._unprotectedResources.length>0)for(var t=0;t<this._unprotectedResources.length;t++)if(e.indexOf(this._unprotectedResources[t])>-1)return null;if(this._protectedResourceMap.size>0)for(var n=0,r=Array.from(this._protectedResourceMap.keys());n<r.length;n++){var o=r[n];if(e.indexOf(o)>-1)return this._protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this.getHostFromUri(e)===this.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},UserAgentApplication.prototype.setloginInProgress=function(e){this._loginInProgress=e},UserAgentApplication.prototype.getAcquireTokenInProgress=function(){return this._acquireTokenInProgress},UserAgentApplication.prototype.setAcquireTokenInProgress=function(e){this._acquireTokenInProgress=e},UserAgentApplication.prototype.getLogger=function(){return this._logger},r.__decorate([b],UserAgentApplication.prototype,"acquireTokenSilent",null),UserAgentApplication}();t.UserAgentApplication=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{"value":!0}),t.default=function symbolObservablePonyfill(e){var t,n=e.Symbol;"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable";return t}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{"enumerable":!0,"get":function(){return e.l}}),Object.defineProperty(e,"id",{"enumerable":!0,"get":function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{"value":!0});var o,i=function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}(n(34));o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:r;var s=(0,i.default)(o);t.default=s}).call(this,n(4),n(35)(e))},function(e,t){!function(t){"use strict";var n,r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag",u="object"==typeof e,l=t.regeneratorRuntime;if(l)u&&(e.exports=l);else{(l=t.regeneratorRuntime=u?e.exports:{}).wrap=wrap;var p="suspendedStart",d="suspendedYield",f="executing",h="completed",g={},m={};m[s]=function(){return this};var y=Object.getPrototypeOf,v=y&&y(y(values([])));v&&v!==r&&o.call(v,s)&&(m=v);var b=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(m);GeneratorFunction.prototype=b.constructor=GeneratorFunctionPrototype,GeneratorFunctionPrototype.constructor=GeneratorFunction,GeneratorFunctionPrototype[c]=GeneratorFunction.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(b),e},l.awrap=function(e){return{"__await":e}},defineIteratorMethods(AsyncIterator.prototype),AsyncIterator.prototype[a]=function(){return this},l.AsyncIterator=AsyncIterator,l.async=function(e,t,n,r){var o=new AsyncIterator(wrap(e,t,n,r));return l.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},defineIteratorMethods(b),b[c]="Generator",b[s]=function(){return this},b.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function next(){for(;t.length;){var n=t.pop();if(n in e)return next.value=n,next.done=!1,next}return next.done=!0,next}},l.values=values,Context.prototype={"constructor":Context,"reset":function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(resetTryEntry),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},"stop":function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},"dispatchException":function(e){if(this.done)throw e;var t=this;function handle(r,o){return s.type="throw",s.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],s=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var a=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},"abrupt":function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(s)},"complete":function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},"finish":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),resetTryEntry(n),g}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;resetTryEntry(n)}return o}}throw new Error("illegal catch attempt")},"delegateYield":function(e,t,r){return this.delegate={"iterator":values(e),"resultName":t,"nextLoc":r},"next"===this.method&&(this.arg=n),g}}}function wrap(e,t,n,r){var o=t&&t.prototype instanceof Generator?t:Generator,i=Object.create(o.prototype),s=new Context(r||[]);return i._invoke=function makeInvokeMethod(e,t,n){var r=p;return function invoke(o,i){if(r===f)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return doneResult()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=maybeInvokeDelegate(s,n);if(a){if(a===g)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===p)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var c=tryCatch(e,t,n);if("normal"===c.type){if(r=n.done?h:d,c.arg===g)continue;return{"value":c.arg,"done":n.done}}"throw"===c.type&&(r=h,n.method="throw",n.arg=c.arg)}}}(e,n,s),i}function tryCatch(e,t,n){try{return{"type":"normal","arg":e.call(t,n)}}catch(e){return{"type":"throw","arg":e}}}function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}function defineIteratorMethods(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function AsyncIterator(e){var t;this._invoke=function enqueue(n,r){function callInvokeWithMethodAndArg(){return new Promise(function(t,i){!function invoke(t,n,r,i){var s=tryCatch(e[t],e,n);if("throw"!==s.type){var a=s.arg,c=a.value;return c&&"object"==typeof c&&o.call(c,"__await")?Promise.resolve(c.__await).then(function(e){invoke("next",e,r,i)},function(e){invoke("throw",e,r,i)}):Promise.resolve(c).then(function(e){a.value=e,r(a)},i)}i(s.arg)}(n,r,t,i)})}return t=t?t.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,maybeInvokeDelegate(e,t),"throw"===t.method))return g;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var o=tryCatch(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,g;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,g):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function pushTryEntry(e){var t={"tryLoc":e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{"tryLoc":"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function next(){for(;++r<e.length;)if(o.call(e,r))return next.value=e[r],next.done=!1,next;return next.value=n,next.done=!0,next};return i.next=i}}return{"next":doneResult}}function doneResult(){return{"value":n,"done":!0}}}(function(){return this}()||Function("return this")())},function(e,t){var n,r,o=e.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(n===setTimeout)return setTimeout(e,0);if((n===defaultSetTimout||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){n=defaultSetTimout}try{r="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){r=defaultClearTimeout}}();var i,s=[],a=!1,c=-1;function cleanUpNextTick(){a&&i&&(a=!1,i.length?s=i.concat(s):c=-1,s.length&&drainQueue())}function drainQueue(){if(!a){var e=runTimeout(cleanUpNextTick);a=!0;for(var t=s.length;t;){for(i=s,s=[];++c<t;)i&&i[c].run();c=-1,t=s.length}i=null,a=!1,function runClearTimeout(e){if(r===clearTimeout)return clearTimeout(e);if((r===defaultClearTimeout||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new Item(e,t)),1!==s.length||a||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=noop,o.addListener=noop,o.once=noop,o.off=noop,o.removeListener=noop,o.removeAllListeners=noop,o.emit=noop,o.prependListener=noop,o.prependOnceListener=noop,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o=1,i={},s=!1,a=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?function installNextTickImplementation(){r=function(e){t.nextTick(function(){runIfPresent(e)})}}():!function canUsePostMessage(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?function installMessageChannelImplementation(){var e=new MessageChannel;e.port1.onmessage=function(e){runIfPresent(e.data)},r=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function installReadyStateChangeImplementation(){var e=a.documentElement;r=function(t){var n=a.createElement("script");n.onreadystatechange=function(){runIfPresent(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function installSetTimeoutImplementation(){r=function(e){setTimeout(runIfPresent,0,e)}}():function installPostMessageImplementation(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&runIfPresent(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}(),c.setImmediate=function setImmediate(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var s={"callback":e,"args":t};return i[o]=s,r(o),o++},c.clearImmediate=clearImmediate}function clearImmediate(e){delete i[e]}function runIfPresent(e){if(s)setTimeout(runIfPresent,0,e);else{var t=i[e];if(t){s=!0;try{!function run(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{clearImmediate(e),s=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(4),n(38))},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function Timeout(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new Timeout(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new Timeout(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function onTimeout(){e._onTimeout&&e._onTimeout()},t))},n(39),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(4))},function(e,t,n){"use strict";(function(t){var n=setTimeout;function noop(){}function Promise(e){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(e,this)}function handle(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,Promise._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void reject(t.promise,e)}resolve(t.promise,r)}else(1===e._state?resolve:reject)(t.promise,e._value)})):e._deferreds.push(t)}function resolve(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof Promise)return e._state=3,e._value=t,void finale(e);if("function"==typeof n)return void doResolve(function bind(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,finale(e)}catch(t){reject(e,t)}}function reject(e,t){e._state=2,e._value=t,finale(e)}function finale(e){2===e._state&&0===e._deferreds.length&&Promise._immediateFn(function(){e._handled||Promise._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)handle(e,e._deferreds[t]);e._deferreds=null}function doResolve(e,t){var n=!1;try{e(function(e){n||(n=!0,resolve(t,e))},function(e){n||(n=!0,reject(t,e))})}catch(e){if(n)return;n=!0,reject(t,e)}}Promise.prototype.catch=function(e){return this.then(null,e)},Promise.prototype.then=function(e,t){var n=new this.constructor(noop);return handle(this,new function Handler(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},Promise.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},Promise.all=function(e){return new Promise(function(t,n){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function res(e,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var s=i.then;if("function"==typeof s)return void s.call(i,function(t){res(e,t)},n)}r[e]=i,0==--o&&t(r)}catch(e){n(e)}}for(var i=0;i<r.length;i++)res(i,r[i])})},Promise.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Promise?e:new Promise(function(t){t(e)})},Promise.reject=function(e){return new Promise(function(t,n){n(e)})},Promise.race=function(e){return new Promise(function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)})},Promise._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){n(e,0)},Promise._unhandledRejectionFn=function _unhandledRejectionFn(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.exports=Promise}).call(this,n(40).setImmediate)},function(e,t,n){(function(e){var t="undefined"!=typeof window&&window.Math===Math?window:"object"==typeof e?e:this;t.Promise||(t.Promise=n(41)),t.regeneratorRuntime||(t.regeneratorRuntime=n(37))}).call(this,n(4))},function(e,t,n){e.exports=n(21)}]);