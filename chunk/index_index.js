(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"113":function(e,n,t){},"120":function(e,n,t){"use strict";t.r(n);var o=t(28),r=t(2),i=t(1),a=t.n(i),c=t(124),l=t(6),u=t(122),s=t(119),p=(t(51),t(5)),f=function login(){return{"type":p.a}},d=function setUser(e){return{"type":p.c,"user":e}},g=t(116),h=t.n(g),y=(t(113),t(111)),b=function(){function defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e}}();var m,v=void 0;m={"clientID":"bacb8d3b-6ee0-4443-9bea-b54485a5a20d","authority":"https://login.microsoftonline.com/tfp/unihearti.onmicrosoft.com/B2C_1_tictactoe","b2cScopes":["https://unihearti.onmicrosoft.com/hello/demo.read"]},v=new y.UserAgentApplication(m.clientID,m.authority,function(e,n,t,o){console.log(e,n,t,o)});var w=function(){function User(){!function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,User)}return b(User,null,[{"key":"getAgent","value":function getAgent(){return v}},{"key":"get","value":function get(){return v.getUser()}},{"key":"login","value":function login(){return v.loginRedirect(m.b2cScopes)}},{"key":"logout","value":function logout(){v.logout()}}]),User}(),_=t(125),k=t(118),C=function(){function defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e}}();var O=function(e){function UserCard(e){return function user_card_classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,UserCard),function _possibleConstructorReturn(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(UserCard.__proto__||Object.getPrototypeOf(UserCard)).call(this,e))}return function _inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(UserCard,r["Component"]),C(UserCard,[{"key":"render","value":function render(){return a.a.createElement(_.a,null,this.props.user&&this.props.user.idToken.emails.map(function(e){return a.a.createElement(k.a,{"title":e,"key":e})}))}}]),UserCard}(),x=function(){function defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e}}();var P=function(e){function LoggedIn(){return function logged_in_classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,LoggedIn),function logged_in_possibleConstructorReturn(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(LoggedIn.__proto__||Object.getPrototypeOf(LoggedIn)).apply(this,arguments))}return function logged_in_inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(LoggedIn,r["Component"]),x(LoggedIn,[{"key":"render","value":function render(){return a.a.createElement(c.a,null,a.a.createElement(O,{"user":this.props.user}))}}]),LoggedIn}(),E=function(){function defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,n,t){return n&&defineProperties(e.prototype,n),t&&defineProperties(e,t),e}}();var I=null;function popupLogic(){try{I.location.href}catch(e){I.close(),window.alert("之前打开的窗口已关闭, 请重新点击并在新打开的窗口中重试。")}finally{I.postMessage("https://uniheart.herokuapp.com/passport/citi?redirect_uri="+encodeURIComponent(location.origin+"/callback/citi"),window.location.origin)}}var j=function(e){function Index(){!function index_classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,Index);var e=function index_possibleConstructorReturn(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(Index.__proto__||Object.getPrototypeOf(Index)).apply(this,arguments));return e.config={"navigationBarTitleText":"我的个人中心"},e.state={"popup":null},e}return function index_inherits(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(Index,r["Component"]),E(Index,[{"key":"componentWillReceiveProps","value":function componentWillReceiveProps(e){console.log(this.props,e)}},{"key":"componentWillUnmount","value":function componentWillUnmount(){}},{"key":"componentDidShow","value":function componentDidShow(){this.props.setUser(w.get())}},{"key":"componentDidHide","value":function componentDidHide(){}},{"key":"handleClick","value":function handleClick(){console.log(arguments)}},{"key":"render","value":function render(){return a.a.createElement(c.a,{"className":"index"},a.a.createElement(u.a,{"onClickRgIconSt":this.handleClick,"onClickRgIconNd":this.handleClick,"onClickLeftIcon":this.handleClick,"color":"#000","title":"我的个人中心","leftText":"返回","leftIconType":"chevron-left","rightFirstIconType":"bullet-list","rightSecondIconType":"user"}),a.a.createElement(c.a,{"className":"container"},this.props.index.user?a.a.createElement(c.a,null,a.a.createElement(P,{"user":this.props.index.user}),a.a.createElement(s.a,{"type":"primary","onClick":this.props.logout,"loading":this.props.index.loading},"Logout")):a.a.createElement(c.a,{"className":"container-main"},a.a.createElement(s.a,{"type":"primary","onClick":this.props.login,"loading":this.props.index.loading},"登录"),a.a.createElement("br",null),a.a.createElement(s.a,{"onClick":this.props.citiLogin.bind(this),"loading":this.props.index.loading},"花旗账号登录"))))}},{"key":"componentDidMount","value":function componentDidMount(){}}]),Index}();j=Object(o.__decorate)([Object(l.connect)(function(e){return{"index":e.index}},function(e){return{"login":function login(){e(f()),w.login().then(function(n){return e(d(n))})},"logout":function logout(){e(function logout(){return{"type":p.b}}()),w.logout(),e(d(null))},"setUser":function setUser(n){e(d(n))},"citiLogin":function citiLogin(){e(f());var n=setInterval(function(){I.closed&&(e(d(null)),clearInterval(n))},1e3);I&&!I.closed||((I=window.open()).document.write("<html><head><title>第三方登录 我的个人中心</title></head><body><p>正在加载中, 请稍等 ……</p><script>window.addEventListener('message', function (event) {\n    console.log(event.data);\n\n    if (event.data.indexOf('http://') === 0 || event.data.indexOf('https://') === 0 || event.data.indexOf('//') === 0) {\n        location.href = event.data;\n    }\n}, false);\n\nwindow.opener.postMessage('listenerLoaded', window.location.origin);<\/script></body></html>"),window.addEventListener("message",function(e){if(console.log("event = ",e),e.origin===window.location.origin&&e.data){if("listenerLoaded"===e.data)return popupLogic();if("string"==typeof e.data&&0===e.data.indexOf("?")){var n=h.a.parse(e.data);return console.log(n),(I||e.source).close()}}},!1)),popupLogic()}}})],j);n.default=j}}]);