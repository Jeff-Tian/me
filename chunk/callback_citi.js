(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"166":function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(39),i=n(1),c=n(159),u=n(9),a=n(165),l=(n(42),n(46)),s=n.n(l),f=n(37),p=n(59),d=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),h=function get(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:get(r,t,n)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(n):void 0};var y=function(e){function Citi(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Citi);var e=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Citi.__proto__||Object.getPrototypeOf(Citi)).apply(this,arguments));return e.config={"navigationBarTitleText":"我的个人中心"},e}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Citi,i["a"].Component),d(Citi,[{"key":"componentWillReceiveProps","value":function componentWillReceiveProps(e){console.log(this.props,e)}},{"key":"componentWillUnmount","value":function componentWillUnmount(){}},{"key":"componentDidShow","value":function componentDidShow(){window.opener&&window.opener.postMessage(window.location.search,window.location.origin),this.props.citiLogin()}},{"key":"componentDidHide","value":function componentDidHide(){}},{"key":"handleClick","value":function handleClick(){console.log(arguments)}},{"key":"handleLeftClick","value":function(){var e=function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(o,r){try{var i=t[o](r),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then(function(e){step("next",e)},function(e){step("throw",e)});e(c)}("next")})}}(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.navigateTo({"url":"/"});case 2:case"end":return e.stop()}},_callee,this)}));return function handleLeftClick(){return e.apply(this,arguments)}}()},{"key":"render","value":function render(){return o.j.createElement(c.a,{"className":"index"},o.j.createElement(a.a,{"onClickRgIconSt":this.handleClick,"onClickRgIconNd":this.handleClick,"onClickLeftIcon":this.handleLeftClick,"color":"#000","title":"我的个人中心","leftText":"返回","leftIconType":"chevron-left","rightFirstIconType":"bullet-list","rightSecondIconType":"user"}),o.j.createElement(c.a,{"className":"container"},o.j.createElement("p",null,"登录成功，窗口即将关闭……")))}},{"key":"componentDidMount","value":function componentDidMount(){h(Citi.prototype.__proto__||Object.getPrototypeOf(Citi.prototype),"componentDidMount",this)&&h(Citi.prototype.__proto__||Object.getPrototypeOf(Citi.prototype),"componentDidMount",this).call(this)}}]),Citi}();y=Object(r.__decorate)([Object(u.b)(function(e){return function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(e),{}},function(e){return{"login":function login(){e(Object(f.b)())},"setUser":function setUser(t){e(Object(f.e)(t))},"citiLogin":function citiLogin(){var t=s.a.parse(window.location.search.substr(1));t.token&&p.a.loginByToken(e)(t).then(i.a.navigateTo)}}})],y),t.default=y},"37":function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return a});var o=n(6),r=function login(){return{"type":o.c}},i=function logout(){return{"type":o.d}},c=function setUser(e){return{"type":o.e,"user":e}},u=function loggedIn(e){return{"type":o.a,"token":e}},a=function loginCancelled(){return{"type":o.b}}},"59":function(e,t,n){"use strict";n.d(t,"a",function(){return f});var o=n(74),r=n(73),i=n(162),c=n(1),u=n(37),a=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var l,s=void 0;l={"clientID":"bacb8d3b-6ee0-4443-9bea-b54485a5a20d","authority":"https://login.microsoftonline.com/tfp/unihearti.onmicrosoft.com/B2C_1_tictactoe","b2cScopes":["https://unihearti.onmicrosoft.com/hello/demo.read"]},s=new o.UserAgentApplication(l.clientID,l.authority,function(e,t,n,o){console.log(e,t,n,o)});var f=function(){function User(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,User)}return a(User,null,[{"key":"getAgent","value":function getAgent(){return s}},{"key":"get","value":function get(){return s.getUser()}},{"key":"login","value":function login(){return s.loginRedirect(l.b2cScopes)}},{"key":"logout","value":function logout(){s.logout()}},{"key":"loginByToken","value":function loginByToken(e){var t,n=this;return t=function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(o,r){try{var i=t[o](r),c=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(c).then(function(e){step("next",e)},function(e){step("throw",e)});e(c)}("next")})}}(regeneratorRuntime.mark(function _callee(t){var o,a;return regeneratorRuntime.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return e(Object(u.a)(t.token)),Object(r.d)("token",t),n.prev=2,e(Object(u.b)()),n.next=6,Object(i.a)({"url":"https://uniheart.pa-ca.me/jwt/user","header":{"Authorization":"Bearer "+t.token,"accept":"application/json"},"method":"GET"});case 6:return o=n.sent,e(Object(u.a)(t.token)),e(Object(u.e)(o.data)),Object(r.d)("userInfo",o.data),n.abrupt("return",{"url":t.returnUrl||"/"});case 13:if(n.prev=13,n.t0=n.catch(2),a="发生了错误",401!==n.t0.status){n.next=22;break}if(a="登录失败",!1!==n.t0.bodyUsed){n.next=22;break}return n.next=21,n.t0.text();case 21:a=n.sent;case 22:c.a.atMessage({"message":a,"type":"error"}),e(Object(u.a)(""));case 24:case"end":return n.stop()}},_callee,n,[[2,13]])})),function(e){return t.apply(this,arguments)}}}]),User}()}}]);