(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"174":function(e,t,n){"use strict";n.r(t);var r=n(0),o=(n(42),n(1)),a=n(123),i=n(172),c=n(161),u=n(158),s=n(67),l=n(69),p=n(173),f=n(151),d=n(157),y=n(154),h=n(9),b=n(60),w=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var m=function(e){function CardList(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CardList),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(CardList.__proto__||Object.getPrototypeOf(CardList)).apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(CardList,o["a"].Component),v(CardList,[{"key":"render","value":function render(){var e=this.props.dispatch,t=o.a.useState([]),n=w(t,2),h=n[0],v=n[1],m=o.a.useState(!1),_=w(m,2),g=_[0],C=_[1];return o.a.useEffect(function(){var t=Object(a.b)("token");t&&t.token?(Object(i.b)({"title":"加载中……"}).then(),Object(c.a)({"url":"https://uniheart.pa-ca.me/citi-dev/cards","header":{"Authorization":"Bearer "+t.token,"accept":"application/json"}}).then(function(e){return v(e.data.cardDetails)},function(t){if(console.error("错误：",t),"Failed to fetch"===t.message||"Unauthorized"===t.statusText)try{Object(b.a)(e)}catch(e){console.error(e),C(!0)}}).finally(i.a)):C(!0)},[]),r.j.createElement(u.a,null,r.j.createElement(u.a,{"className":"at-article__h2"},"我的卡片："),h.map(function(e){return r.j.createElement(l.a,{"title":e.displayCardNumber,"note":e.localCardActivationIndicator,"extra":e.subCardType},e.currentCreditLimitAmount)}),r.j.createElement(p.a,{"isOpened":g},r.j.createElement(f.a,null,"请授权"),r.j.createElement(d.a,null,"您还没有授权，或者之前的授权已过期，需要重新授权。"),r.j.createElement(y.a,null,r.j.createElement(s.a,{"onClick":function onClick(){return C(!1)}},"取消"),r.j.createElement(s.a,{"onClick":function onClick(){C(!0),Object(b.a)(e)}},"确定"))))}}]),CardList}(),_=Object(h.b)(function(){return{}})(m),g=n(34);n.d(t,"default",function(){return j});var C=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),O=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:get(o,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0};var j=function(e){function Cards(){!function cards_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Cards);var e=function cards_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Cards.__proto__||Object.getPrototypeOf(Cards)).apply(this,arguments));return e.config={"navigationBarTitleText":"卡片信息"},e}return function cards_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Cards,o["a"].Component),C(Cards,[{"key":"render","value":function render(){return r.j.createElement(g.a,null,r.j.createElement(_,null))}},{"key":"componentDidMount","value":function componentDidMount(){O(Cards.prototype.__proto__||Object.getPrototypeOf(Cards.prototype),"componentDidMount",this)&&O(Cards.prototype.__proto__||Object.getPrototypeOf(Cards.prototype),"componentDidMount",this).call(this)}},{"key":"componentDidShow","value":function componentDidShow(){O(Cards.prototype.__proto__||Object.getPrototypeOf(Cards.prototype),"componentDidShow",this)&&O(Cards.prototype.__proto__||Object.getPrototypeOf(Cards.prototype),"componentDidShow",this).call(this)}},{"key":"componentDidHide","value":function componentDidHide(){O(Cards.prototype.__proto__||Object.getPrototypeOf(Cards.prototype),"componentDidHide",this)&&O(Cards.prototype.__proto__||Object.getPrototypeOf(Cards.prototype),"componentDidHide",this).call(this)}}]),Cards}()},"34":function(e,t,n){"use strict";var r=n(0),o=n(1),a=n(158),i=n(159),c=n(164),u=n(163),s=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var l=new Map([["账号信息","/"],["账号绑定","/pages/accounts/bind"],["卡片信息","/pages/cards/cards"],["产品列表","/pages/cards/product-list"]]),p=function(e){function Drawer(){return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Drawer),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Drawer.__proto__||Object.getPrototypeOf(Drawer)).apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Drawer,o["a"].Component),s(Drawer,[{"key":"render","value":function render(){var e,t=this,n=this.props,a=(e=function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,o){try{var a=t[r](o),i=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(e){return regeneratorRuntime.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.navigateTo({"url":[].concat(_toConsumableArray(l.values()))[e]});case 2:case"end":return t.stop()}},_callee,t)})),function onItemClick(t){return e.apply(this,arguments)});return r.j.createElement(u.a,{"show":n.show,"right":!0,"mask":!0,"onClose":n.onClose,"items":[].concat(_toConsumableArray(l.keys())),"onItemClick":a})}}]),Drawer}();n.d(t,"a",function(){return y});var f=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var y=function(e){function HardwayLayout(){return function layout_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HardwayLayout),function layout_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(HardwayLayout.__proto__||Object.getPrototypeOf(HardwayLayout)).apply(this,arguments))}return function layout_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(HardwayLayout,o["a"].Component),d(HardwayLayout,[{"key":"render","value":function render(){var e=this.props,t=o.a.useState(!1),n=f(t,2),u=n[0],s=n[1];return r.j.createElement(a.a,{"className":"index"},r.j.createElement(i.a,null),r.j.createElement(c.a,{"onClickRgIconSt":function onOpenDrawer(){return s(!0)},"onClickRgIconNd":function onClickRgIconNd(){},"onClickLeftIcon":function onClickLeftIcon(){},"color":"#000","title":"我的个人中心","leftText":"返回","leftIconType":"chevron-left","rightFirstIconType":"bullet-list","rightSecondIconType":"user"}),r.j.createElement(a.a,{"className":"container"},e.children),r.j.createElement(p,{"show":u,"onClose":function onCloseDrawer(){return s(!1)}}))}}]),HardwayLayout}()},"38":function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return u});var r=n(6),o=function login(){return{"type":r.c}},a=function logout(){return{"type":r.d}},i=function setUser(e){return{"type":r.e,"user":e}},c=function loggedIn(e){return{"type":r.a,"token":e}},u=function loginCancelled(){return{"type":r.b}}},"60":function(e,t,n){"use strict";var r=n(123),o=n(161),a=n(1),i=n(54),c=n.n(i),u=n(38);var s=null;function popupLogic(){try{s.location.href}catch(e){console.error("打开子窗口失败：",e),s.close(),window.alert("之前打开的窗口已关闭, 请重新点击并在新打开的窗口中重试。")}finally{s&&s.postMessage("https://uniheart.herokuapp.com/passport/citi?redirect_uri="+encodeURIComponent(window.location.origin+"/pages/callback/citi"),window.location.origin)}}t.a=function(e){Object(r.e)("returnPath",window.location.pathname),e(Object(u.b)());var t,n=setInterval(function(){s?s.closed&&(console.log("login cancelled!"),e(Object(u.c)()),clearInterval(n),window.location.reload()):clearInterval(n)},1e3);s&&!s.closed||(s=window.open())&&s.document.write('<html>\n  <head>\n    <title>第三方登录 我的个人中心</title>\n  </head>\n  <body>\n    <p>正在加载中, 请稍等 ……</p>\n    <script>\n      window.addEventListener(\n        "message",\n        function(event) {\n          console.log(event.data);\n\n          if (\n            event.data.indexOf("http://") === 0 ||\n            event.data.indexOf("https://") === 0 ||\n            event.data.indexOf("//") === 0\n          ) {\n            location.href = event.data;\n          }\n        },\n        false\n      );\n\n      window.opener.postMessage("listenerLoaded", window.location.origin);\n    <\/script>\n  </body>\n</html>\n'),window.addEventListener("message",(t=function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(r,o){try{var a=t[r](o),i=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(t){var n,i,l;return regeneratorRuntime.wrap(function _callee$(p){for(;;)switch(p.prev=p.next){case 0:if(console.log("event = ",t),t.origin===window.location.origin){p.next=3;break}return p.abrupt("return");case 3:if(t.data){p.next=5;break}return p.abrupt("return");case 5:if("listenerLoaded"!==t.data){p.next=7;break}return p.abrupt("return",popupLogic());case 7:if("string"!=typeof t.data||0!==t.data.indexOf("?")){p.next=27;break}if(n=c.a.parse(t.data.substr(1)),console.log(n),!n.token){p.next=26;break}return e(Object(u.a)(n.token)),p.prev=12,p.next=15,Object(o.a)({"url":"https://uniheart.pa-ca.me/jwt/user","header":{"Authorization":"Bearer "+n.token},"method":"GET"});case 15:return i=p.sent,e(Object(u.e)(i.data)),l=Object(r.b)("returnPath"),console.log("即将跳转到：",l),p.next=21,a.a.navigateTo({"url":l,"success":function success(){return Object(r.c)("returnPath")}});case 21:p.next=26;break;case 23:p.prev=23,p.t0=p.catch(12),console.error(p.t0);case 26:return p.abrupt("return",(s||t.source).close());case 27:case"end":return p.stop()}},_callee,this,[[12,23]])})),function(e){return t.apply(this,arguments)}),!1),popupLogic()}}}]);